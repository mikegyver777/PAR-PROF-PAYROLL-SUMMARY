<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aloha Doors - Door Order System</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif; background: #f5f5f5; padding: 20px; line-height: 1.6; }
        .container { max-width: 1500px; margin: 0 auto; }
        .header { background: linear-gradient(135deg, #8B0000, #DC143C); color: white; padding: 20px 30px; border-radius: 12px; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px; }
        .logo-section { display: flex; align-items: center; gap: 15px; }
        .logo-icon { font-size: 40px; }
        .logo-text { font-size: 28px; font-weight: bold; letter-spacing: 2px; }
        .logo-subtitle { font-size: 12px; opacity: 0.9; letter-spacing: 1px; }
        .header-actions { display: flex; gap: 10px; flex-wrap: wrap; }
        .btn { padding: 10px 20px; border: none; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: 600; transition: all 0.2s; display: inline-flex; align-items: center; gap: 6px; }
        .btn-primary { background: white; color: #8B0000; }
        .btn-primary:hover { background: #f0f0f0; }
        .btn-success { background: #16a34a; color: white; }
        .btn-success:hover { background: #15803d; }
        .btn-blue { background: #2563eb; color: white; }
        .btn-blue:hover { background: #1d4ed8; }
        .btn-danger { background: #dc2626; color: white; padding: 6px 12px; font-size: 12px; }
        .btn-outline { background: transparent; border: 2px solid #e5e7eb; color: #374151; }
        .btn-outline:hover { border-color: #8B0000; color: #8B0000; }
        .btn-sm { padding: 6px 12px; font-size: 12px; }
        .tabs-container { background: white; padding: 15px 20px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .tabs { display: flex; gap: 8px; flex-wrap: wrap; align-items: center; }
        .tab { display: flex; align-items: center; gap: 5px; }
        .tab-btn { padding: 10px 16px; border: none; background: #e5e7eb; color: #374151; cursor: pointer; font-weight: 600; border-radius: 8px; transition: all 0.2s; font-size: 14px; }
        .tab-btn.active { background: #8B0000; color: white; }
        .tab-btn:hover:not(.active) { background: #d1d5db; }
        .tab-qty { background: rgba(255,255,255,0.3); padding: 2px 8px; border-radius: 10px; font-size: 11px; margin-left: 5px; }
        .main-grid { display: grid; grid-template-columns: 1fr 400px; gap: 20px; }
        @media (max-width: 1100px) { .main-grid { grid-template-columns: 1fr; } }
        .card { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px; }
        .card h2 { font-size: 16px; color: #1a1a1a; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid #8B0000; display: flex; align-items: center; gap: 8px; }
        .form-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 12px; margin-bottom: 12px; }
        .form-group { display: flex; flex-direction: column; gap: 4px; }
        label { font-size: 11px; font-weight: 600; color: #6b7280; text-transform: uppercase; letter-spacing: 0.5px; }
        input, select, textarea { width: 100%; padding: 8px 10px; border: 2px solid #e5e7eb; border-radius: 6px; font-size: 14px; transition: border 0.2s; }
        input:focus, select:focus, textarea:focus { outline: none; border-color: #8B0000; }
        textarea { resize: vertical; min-height: 80px; }
        .help-text { font-size: 11px; color: #9ca3af; }
        .pricing-row { display: grid; grid-template-columns: 1fr 80px 1fr 1fr; gap: 8px; align-items: end; padding: 10px; background: #f9fafb; border-radius: 6px; margin-bottom: 8px; }
        .pricing-row .cost-input { background: #fef3c7; }
        .pricing-row .markup-input { background: #e0f2fe; }
        .pricing-row .sell-price { background: #d1fae5; font-weight: 600; }
        .pricing-row .labor-input { background: #fce7f3; }
        .summary-panel { position: sticky; top: 20px; }
        .summary-header { background: #8B0000; color: white; padding: 15px; border-radius: 12px 12px 0 0; margin: -20px -20px 15px -20px; }
        .summary-header h2 { color: white; border: none; margin: 0; padding: 0; }
        .quantity-display { background: linear-gradient(135deg, #1e40af, #3b82f6); color: white; padding: 15px; border-radius: 8px; text-align: center; margin-bottom: 15px; }
        .quantity-display .qty-number { font-size: 36px; font-weight: bold; }
        .quantity-display .qty-label { font-size: 12px; opacity: 0.9; }
        .summary-item { border-left: 3px solid #8B0000; padding: 10px 12px; margin-bottom: 10px; background: #fafafa; border-radius: 0 6px 6px 0; }
        .summary-category { font-size: 10px; font-weight: 700; color: #8B0000; text-transform: uppercase; }
        .summary-item-name { font-size: 14px; font-weight: 600; color: #1a1a1a; margin: 3px 0; }
        .summary-details { font-size: 12px; color: #6b7280; }
        .summary-price { font-size: 13px; font-weight: 600; color: #16a34a; margin-top: 4px; }
        .totals-section { border-top: 2px solid #e5e7eb; padding-top: 15px; margin-top: 15px; }
        .total-row { display: flex; justify-content: space-between; padding: 6px 0; font-size: 14px; }
        .total-row.subtotal { color: #6b7280; }
        .total-row.grand-total { font-size: 20px; font-weight: bold; color: #1a1a1a; border-top: 2px solid #1a1a1a; padding-top: 10px; margin-top: 5px; }
        .hardware-list { border: 1px solid #e5e7eb; border-radius: 8px; overflow: hidden; }
        .hardware-item { padding: 12px; border-bottom: 1px solid #e5e7eb; background: #fafafa; }
        .hardware-item:last-child { border-bottom: none; }
        .hardware-item-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .hardware-item-title { font-weight: 600; font-size: 13px; color: #374151; }
        .modal-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); display: flex; justify-content: center; align-items: center; z-index: 1000; opacity: 0; visibility: hidden; transition: all 0.3s; }
        .modal-overlay.active { opacity: 1; visibility: visible; }
        .modal { background: white; border-radius: 12px; max-width: 900px; width: 95%; max-height: 90vh; overflow: hidden; display: flex; flex-direction: column; }
        .modal-header { padding: 20px; background: #8B0000; color: white; display: flex; justify-content: space-between; align-items: center; }
        .modal-header h2 { color: white; margin: 0; border: none; padding: 0; }
        .modal-close { background: none; border: none; color: white; font-size: 24px; cursor: pointer; }
        .modal-body { padding: 20px; overflow-y: auto; flex: 1; }
        .modal-footer { padding: 15px 20px; border-top: 1px solid #e5e7eb; display: flex; justify-content: flex-end; gap: 10px; }
        @media print { .no-print { display: none !important; } }
        .mt-10 { margin-top: 10px; }
        
        /* Data Specs Styles */
        .spec-item { border: 1px solid #e5e7eb; border-radius: 8px; padding: 12px; margin-bottom: 12px; background: #fafafa; }
        .spec-item-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .spec-item-title { font-weight: 600; font-size: 13px; color: #8B0000; }
        .spec-item-content { display: grid; grid-template-columns: 150px 1fr; gap: 12px; }
        .spec-image-area { min-height: 100px; border: 2px dashed #d1d5db; border-radius: 6px; display: flex; align-items: center; justify-content: center; background: white; overflow: hidden; }
        .spec-image-area img { max-width: 100%; max-height: 120px; object-fit: contain; }
        .spec-image-area.empty { color: #9ca3af; font-size: 12px; text-align: center; padding: 10px; cursor: pointer; }
        .spec-image-area.empty:hover { border-color: #8B0000; color: #8B0000; }
        .spec-notes textarea { min-height: 80px; font-size: 12px; }
    </style>
</head>
<body>
<div class="container">
    <div class="header no-print">
        <div class="logo-section">
            <img src="data:image/webp;base64,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" alt="Aloha Doors" style="height: 55px;">
            <div style="margin-left: 15px; font-size: 12px; color: #ffffff; font-weight: 500; letter-spacing: 0.3px;">214 Main St. #119, El Segundo CA 90245<br><span style="font-weight: 600;">(310) 414-0488</span> ‚Ä¢ alohadoors.com</div>
        </div>
        <div class="header-actions">
            <button class="btn btn-primary" onclick="printSpecSheet()">üñ®Ô∏è Print</button>
            <button class="btn btn-primary" onclick="saveSpecSheet()">üíæ Save</button>
            <button class="btn btn-primary" onclick="openEmailModal()">üìß Email</button>
            <button class="btn btn-primary" onclick="copyOrderText()">üìã Copy</button>
            <input type="file" id="importFile" accept=".json" style="display:none" onchange="importJSON(event)">
            <button class="btn btn-success" onclick="addNewDoor()">‚ûï Add Door</button>
        </div>
    </div>

    <div class="tabs-container no-print">
        <div class="tabs" id="doorTabs"></div>
    </div>

    <div class="main-grid">
        <div id="configPanel" class="no-print">
            <div class="card">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <h2 style="margin: 0;"><span class="icon">üìã</span> Job Information</h2>
                    <div style="display: flex; gap: 8px; align-items: center;">
                        <select id="presetSelector" onchange="loadPreset(this.value)" style="padding: 8px 12px; border-radius: 6px; border: 1px solid #d1d5db; font-size: 13px; min-width: 180px;">
                            <option value="">‚Äî Load Preset ‚Äî</option>
                        </select>
                        <button class="btn btn-success btn-sm" onclick="openSavePresetModal()" style="white-space: nowrap;">üíæ Save Preset</button>
                        <button class="btn btn-danger btn-sm" onclick="deleteCurrentPreset()" style="white-space: nowrap;">üóëÔ∏è</button>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group"><label>Estimate #</label><input type="text" id="estimateNumber" onchange="updateJobInfo()"></div>
                    <div class="form-group"><label>Date</label><input type="date" id="estimateDate" onchange="updateJobInfo()"></div>
                    <div class="form-group"><label>Customer Name</label><input type="text" id="customerName" placeholder="Customer / Company Name" onchange="updateJobInfo()"></div>
                    <div class="form-group"><label>Job Reference</label><input type="text" id="jobReference" placeholder="Project Name / PO#" onchange="updateJobInfo()"></div>
                </div>
                <div class="form-row">
                    <div class="form-group" style="flex: 2;"><label>Job Site Address</label><input type="text" id="jobAddress" placeholder="123 Main St, City, State ZIP" onchange="updateJobInfo()"></div>
                    <div class="form-group" style="flex: 2;">
                        <label>Delivery Address</label>
                        <div style="display: flex; gap: 10px; align-items: center;">
                            <input type="text" id="deliveryAddress" placeholder="Leave blank if same as job site" onchange="updateJobInfo(); document.getElementById('sameAsJobSite').checked = false;" style="flex: 1;">
                            <label style="display: flex; align-items: center; gap: 5px; font-size: 12px; white-space: nowrap; cursor: pointer;"><input type="checkbox" id="sameAsJobSite" onchange="copyJobSiteToDelivery()"> Same as Job Site</label>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2><span class="icon">üö™</span> Door Information</h2>
                <div class="form-row">
                    <div class="form-group"><label>Quantity</label><input type="number" id="doorQuantity" value="1" min="1" onchange="updateQuantity()"><span class="help-text">How many of this door</span></div>
                    <div class="form-group"><label>Width (in)</label><input type="number" id="doorWidth" placeholder="36" onchange="updateDoor()"></div>
                    <div class="form-group"><label>Height (in)</label><input type="number" id="doorHeight" placeholder="84" onchange="updateDoor()"></div>
                    <div class="form-group"><label>Thickness</label><select id="doorThickness" onchange="updateDoor()"><option value="1-3/8">1-3/8"</option><option value="1-3/4" selected>1-3/4"</option><option value="2">2"</option></select></div>
                </div>
                <div class="form-row">
                    <div class="form-group"><label>Door Type</label><select id="doorType" onchange="updateDoorType()"><option value="">-- Select --</option><optgroup label="HM (Hollow Metal)"><option value="HM-3HR">HM - 3 Hour Fire Rated</option><option value="HM-90">HM - 90 Min Fire Rated</option><option value="HM-45">HM - 45 Min Fire Rated</option><option value="HM-20">HM - 20 Min Fire Rated</option><option value="HM-STD">HM - Non-Rated</option></optgroup><optgroup label="Specialty"><option value="RF">RF Shielded Door</option><option value="STC">STC Acoustic Door</option></optgroup><optgroup label="WD (Wood)"><option value="WD-PAINT">WD - Paint Grade</option><option value="WD-STAIN">WD - Stain Grade</option><option value="WD-LAM">WD - Laminate</option></optgroup><option value="OTHER">Other</option></select><input type="text" id="doorTypeManual" placeholder="Enter door type..." style="display:none; margin-top:6px;" onchange="updateDoor()"></div>
                    <div class="form-group"><label>Brand</label><select id="doorBrand" onchange="updateDoorBrand()"><option value="">-- Select --</option></select><input type="text" id="doorBrandManual" placeholder="Enter brand..." style="display:none; margin-top:6px;" onchange="updateDoor()"></div>
                    <div class="form-group"><label>Model/Series</label><select id="doorModel" onchange="updateDoorModel()"><option value="">-- Select --</option></select><input type="text" id="doorModelManual" placeholder="Enter model..." style="display:none; margin-top:6px;" onchange="updateDoor()"></div>
                </div>
                <div class="form-row">
                    <div class="form-group"><label>Fire Rating</label><select id="doorFireRating" onchange="updateDoor()"><option value="None">None</option><option value="20-min">20 Min</option><option value="45-min">45 Min</option><option value="60-min">60 Min</option><option value="90-min">90 Min</option><option value="3-hr">3 Hour</option></select></div>
                    <div class="form-group"><label>Handing</label><select id="doorHanding" onchange="updateDoor()"><option value="LH">LH - Left Hand</option><option value="RH">RH - Right Hand</option><option value="LHR">LHR - Left Hand Reverse</option><option value="RHR">RHR - Right Hand Reverse</option></select></div>
                    <div class="form-group"><label>Swing</label><select id="doorSwing" onchange="updateDoor()"><option value="Inswing">Inswing</option><option value="Outswing">Outswing</option></select></div>
                </div>
                <div class="pricing-row">
                    <div class="form-group"><label>Your Cost</label><input type="number" id="doorCost" class="cost-input" placeholder="0.00" step="0.01" onchange="updateDoor()"></div>
                    <div class="form-group"><label>Markup %</label><input type="number" id="doorMarkup" class="markup-input" value="30" step="1" onchange="updateDoor()"></div>
                    <div class="form-group"><label>Sell Price</label><input type="text" id="doorSellPrice" class="sell-price" readonly></div>
                    <div class="form-group"><label>Labor</label><input type="number" id="doorLabor" class="labor-input" placeholder="0.00" step="0.01" onchange="updateDoor()"></div>
                </div>
            </div>

            <div class="card">
                <h2><span class="icon">üî≤</span> Frame</h2>
                <div class="form-row">
                    <div class="form-group"><label>Frame Type</label><select id="frameType" onchange="updateFrameType()"><option value="">-- Select --</option><optgroup label="KD Frames"><option value="KD-DW-16">KD - Drywall 16 Ga.</option><option value="KD-DW-14">KD - Drywall 14 Ga.</option><option value="KD-MASONRY">KD - Masonry/Block</option><option value="KD-EXIST">KD - Existing Opening</option></optgroup><optgroup label="Welded Frames"><option value="WLD-DW">Welded - Drywall</option><option value="WLD-MASONRY">Welded - Masonry/CMU</option><option value="WLD-CONCRETE">Welded - Concrete</option></optgroup><optgroup label="Configurations"><option value="SINGLE">Single Door Frame</option><option value="PAIR">Pair Frame</option><option value="SL-1">Single + 1 Sidelite</option><option value="DBL-EGRESS">Double Egress</option></optgroup><option value="OTHER">Other</option></select><input type="text" id="frameTypeManual" placeholder="Enter frame type..." style="display:none; margin-top:6px;" onchange="updateDoor()"></div>
                    <div class="form-group"><label>Brand</label><select id="frameBrand" onchange="updateFrameBrand()"><option value="">-- Select --</option></select><input type="text" id="frameBrandManual" placeholder="Enter brand..." style="display:none; margin-top:6px;" onchange="updateDoor()"></div>
                    <div class="form-group"><label>Model/Series</label><select id="frameModel" onchange="updateFrameModel()"><option value="">-- Select --</option></select><input type="text" id="frameModelManual" placeholder="Enter model..." style="display:none; margin-top:6px;" onchange="updateDoor()"></div>
                </div>
                <div class="form-row">
                    <div class="form-group"><label>Frame Material</label><select id="frameMaterial" onchange="updateDoor()"><option value="HM-16">HM 16 Ga.</option><option value="HM-14">HM 14 Ga.</option><option value="HM-12">HM 12 Ga.</option><option value="WD">Wood</option><option value="AL">Aluminum</option><option value="SS">Stainless Steel</option></select></div>
                    <div class="form-group"><label>Anchors</label><select id="frameAnchors" onchange="updateDoor()"><option value="Masonry-T">Masonry T-Anchor</option><option value="Steel-Stud">Steel Stud</option><option value="Wood-Stud">Wood Stud</option><option value="Compression">Compression</option><option value="Existing">Existing</option></select></div>
                    <div class="form-group"><label>Jamb Depth</label><select id="frameJambDepth" onchange="updateDoor()"><option value="4-3/4">4-3/4" (Std Drywall)</option><option value="5-3/4">5-3/4"</option><option value="6-3/4">6-3/4"</option><option value="8-3/4">8-3/4" (Masonry)</option></select></div>
                    <div class="form-group"><label>Head/Strike Prep</label><select id="framePrep" onchange="updateDoor()"><option value="STD">Standard (161)</option><option value="MORTISE">Mortise Lock</option><option value="DEADBOLT">Deadbolt</option><option value="ELECTRIC">Electric Strike</option><option value="NONE">No Prep</option></select></div>
                </div>
                <div class="pricing-row">
                    <div class="form-group"><label>Your Cost</label><input type="number" id="frameCost" class="cost-input" placeholder="0.00" step="0.01" onchange="updateDoor()"></div>
                    <div class="form-group"><label>Markup %</label><input type="number" id="frameMarkup" class="markup-input" value="30" step="1" onchange="updateDoor()"></div>
                    <div class="form-group"><label>Sell Price</label><input type="text" id="frameSellPrice" class="sell-price" readonly></div>
                    <div class="form-group"><label>Labor</label><input type="number" id="frameLabor" class="labor-input" placeholder="0.00" step="0.01" onchange="updateDoor()"></div>
                </div>
            </div>

            <div class="card">
                <h2><span class="icon">üîß</span> Hardware</h2>
                <div class="hardware-list" id="hardwareList"></div>
                <button class="btn btn-outline btn-sm mt-10" onclick="addHardwareItem()">+ Add Hardware</button>
            </div>

            <div class="card">
                <h2><span class="icon">üìù</span> Notes</h2>
                <textarea id="doorNotes" placeholder="Special instructions or requirements..." onchange="updateDoor()"></textarea>
            </div>

            <!-- DATA SPECS SECTION -->
            <div class="card">
                <h2><span class="icon">üìã</span> Data Spec Sheets</h2>
                
                <!-- Quantity Display -->
                <div style="background: linear-gradient(135deg, #1e40af, #3b82f6); color: white; padding: 15px; border-radius: 8px; margin-bottom: 15px; display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <div style="font-size: 12px; opacity: 0.9;">QUANTITY FOR THIS CONFIGURATION</div>
                        <div style="font-size: 28px; font-weight: bold;" id="specQtyDisplay">1</div>
                    </div>
                    <div style="text-align: right;">
                        <label style="font-size: 10px; color: white; opacity: 0.9;">ADJUST QTY</label>
                        <input type="number" id="specQtyInput" value="1" min="1" style="width: 80px; padding: 8px; font-size: 18px; font-weight: bold; text-align: center; border: none; border-radius: 6px;" onchange="updateQtyFromSpecs(this.value)">
                    </div>
                </div>
                
                <p style="font-size:12px; color:#6b7280; margin-bottom:15px;">Upload images and notes for this door configuration. These will appear on printed spec sheets and are saved with configurations.</p>
                
                <div id="dataSpecsContainer">
                    <!-- DOOR SPECIFICATIONS CATEGORY -->
                    <div style="background: #8B0000; color: white; padding: 8px 15px; border-radius: 6px; margin-bottom: 10px; font-weight: bold; font-size: 13px;">
                        üö™ DOOR SPECIFICATIONS
                    </div>
                    <div class="spec-item">
                        <div class="spec-item-header">
                            <span class="spec-item-title">Door Spec Sheet</span>
                        </div>
                        <div class="spec-item-content">
                            <div class="spec-image-area empty" id="doorSpecImage" onclick="document.getElementById('doorSpecImageInput').click()">
                                Click to upload image
                            </div>
                            <input type="file" id="doorSpecImageInput" accept="image/*" style="display:none" onchange="handleSpecImageUpload('door', event)">
                            <div class="spec-notes">
                                <textarea id="doorSpecNotes" placeholder="Door technical specifications..." onchange="updateSpecNotes('door')"></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- FRAME SPECIFICATIONS CATEGORY -->
                    <div style="background: #8B0000; color: white; padding: 8px 15px; border-radius: 6px; margin: 15px 0 10px; font-weight: bold; font-size: 13px;">
                        üî≤ FRAME SPECIFICATIONS
                    </div>
                    <div class="spec-item">
                        <div class="spec-item-header">
                            <span class="spec-item-title">Frame Spec Sheet</span>
                        </div>
                        <div class="spec-item-content">
                            <div class="spec-image-area empty" id="frameSpecImage" onclick="document.getElementById('frameSpecImageInput').click()">
                                Click to upload image
                            </div>
                            <input type="file" id="frameSpecImageInput" accept="image/*" style="display:none" onchange="handleSpecImageUpload('frame', event)">
                            <div class="spec-notes">
                                <textarea id="frameSpecNotes" placeholder="Frame technical specifications..." onchange="updateSpecNotes('frame')"></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- HARDWARE SPECIFICATIONS CATEGORY -->
                    <div style="background: #8B0000; color: white; padding: 8px 15px; border-radius: 6px; margin: 15px 0 10px; font-weight: bold; font-size: 13px;">
                        üîß HARDWARE SPECIFICATIONS
                    </div>
                    <div id="hardwareSpecsContainer"></div>
                </div>
            </div>
        </div>

        <div class="summary-panel no-print">
            <div class="card">
                <div class="summary-header"><h2>üìã <span id="summaryDoorLabel">Customer</span></h2><div id="summaryJobRef" style="font-size: 14px; color: white; margin-top: 4px; font-weight: 600;"></div></div>
                <div id="summaryContent"></div>
                <div class="totals-section">
                    <div class="total-row subtotal"><span>Materials:</span><span id="materialsSubtotal">$0.00</span></div>
                    <div class="total-row subtotal"><span>Labor:</span><span id="laborSubtotal">$0.00</span></div>
                    <div class="total-row subtotal"><span>Door Total (√ó<span id="qtyMultiplier">1</span>):</span><span id="doorTotal">$0.00</span></div>
                    <div class="total-row grand-total"><span>All Doors:</span><span id="grandTotal">$0.00</span></div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Configs Modal -->
<!-- Email Modal -->
<div class="modal-overlay" id="emailModal">
    <div class="modal" style="max-width:550px;">
        <div class="modal-header"><h2>üìß Email Invoice & Specs</h2><button class="modal-close" onclick="closeEmailModal()">&times;</button></div>
        <div class="modal-body">
            <p style="color:#6b7280; margin-bottom:15px; font-size:13px;">Send the invoice and specification sheets via email. The spec sheet will be downloaded automatically for you to attach.</p>
            
            <div class="form-group" style="margin-bottom:15px;">
                <label style="font-weight:600;">Recipient Email</label>
                <input type="email" id="emailTo" placeholder="supplier@example.com" style="width:100%; padding:12px; border:1px solid #d1d5db; border-radius:6px; font-size:14px;">
            </div>
            
            <div class="form-group" style="margin-bottom:15px;">
                <label style="font-weight:600;">CC (optional)</label>
                <input type="email" id="emailCc" placeholder="manager@company.com" style="width:100%; padding:12px; border:1px solid #d1d5db; border-radius:6px; font-size:14px;">
            </div>
            
            <div class="form-group" style="margin-bottom:15px;">
                <label style="font-weight:600;">Subject</label>
                <input type="text" id="emailSubject" style="width:100%; padding:12px; border:1px solid #d1d5db; border-radius:6px; font-size:14px;">
            </div>
            
            <div class="form-group" style="margin-bottom:15px;">
                <label style="font-weight:600;">Message</label>
                <textarea id="emailBody" rows="6" style="width:100%; padding:12px; border:1px solid #d1d5db; border-radius:6px; font-size:14px; resize:vertical;"></textarea>
            </div>
            
            <div style="background:#fef3c7; border:1px solid #f59e0b; border-radius:6px; padding:12px; font-size:12px; color:#92400e;">
                <strong>üìé Attachment:</strong> When your email client opens, please attach the spec sheet file that will be downloaded automatically.
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn btn-outline" onclick="closeEmailModal()">Cancel</button>
            <button class="btn btn-success" onclick="sendEmail()">üìß Open Email Client</button>
        </div>
    </div>
</div>

<!-- Save Preset Modal -->
<div class="modal-overlay" id="savePresetModal">
    <div class="modal" style="max-width:500px;">
        <div class="modal-header"><h2>üíæ Save Door Preset</h2><button class="modal-close" onclick="closeSavePresetModal()">&times;</button></div>
        <div class="modal-body">
            <p style="color:#6b7280; margin-bottom:15px; font-size:13px;">Save this door configuration as a reusable preset. Includes door specs, frame specs, hardware, and images. Job info and quantity are NOT saved.</p>
            <div class="form-group">
                <label style="font-weight:600;">Preset Name</label>
                <input type="text" id="presetName" placeholder="e.g., 3HR Fire Door 36x84 w/ Panic" style="width:100%; padding:12px; border:1px solid #d1d5db; border-radius:6px; font-size:14px;">
            </div>
            <div id="presetPreview" style="background:#f9fafb; border:1px solid #e5e7eb; border-radius:6px; padding:12px; margin-top:15px; font-size:12px; max-height:200px; overflow-y:auto;">
                <!-- Preview will be populated -->
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn btn-outline" onclick="closeSavePresetModal()">Cancel</button>
            <button class="btn btn-success" onclick="savePreset()">üíæ Save Preset</button>
        </div>
    </div>
</div>

<div class="modal-overlay" id="configModal">
    <div class="modal" style="max-width:700px;">
        <div class="modal-header"><h2>üì¶ Saved Configurations</h2><button class="modal-close" onclick="closeConfigModal()">&times;</button></div>
        <div class="modal-body">
            <div style="display:flex; gap:15px; margin-bottom:20px; padding-bottom:20px; border-bottom:1px solid #e5e7eb;">
                <input type="text" id="configName" placeholder="Configuration name..." style="flex:1; padding:10px; border:1px solid #d1d5db; border-radius:6px;">
                <button class="btn btn-success" onclick="saveCurrentConfig()">üíæ Save Current</button>
            </div>
            <h4 style="margin-bottom:15px; color:#374151;">Saved Configurations</h4>
            <div id="savedConfigsList" style="max-height:400px; overflow-y:auto;"><p style="color:#9ca3af; text-align:center; padding:20px;">No saved configurations</p></div>
        </div>
        <div class="modal-footer"><button class="btn btn-outline" onclick="closeConfigModal()">Close</button></div>
    </div>
</div>

<script>
const AppState = { job: { estimateNumber: '', estimateDate: '', customerName: '', jobReference: '', jobAddress: '', deliveryAddress: '' }, doors: [], activeIndex: 0 };

const BrandLibrary = {
    doors: { 'Ceco Door': ['Standard', 'Imperial', 'Storm'], 'Curries': ['707', '747'], 'Steelcraft': ['L-Series', 'B-Series'], 'Republic': ['Standard', 'Heavy Duty'], 'Masonite': ['Safe N Sound', 'Solidoor'], 'VT Industries': ['VT1000', 'VT5000'], 'Other': ['Manual Entry'] },
    frames: { 'Ceco Door': ['KD Series', 'Welded'], 'Curries': ['665', '767'], 'Steelcraft': ['F-Series', 'WF-Series'], 'Timely': ['Classic', 'Prefinished'], 'Other': ['Manual Entry'] },
    hardware: { 'Von Duprin': ['98/99', '22 Series', '33A/35A'], 'Schlage': ['AL Series', 'ND Series', 'L9000'], 'Norton': ['8500', '8000', '7500'], 'LCN': ['4041', '4040XP'], 'Best': ['9K', '45H', 'IC Core'], 'Hager': ['4300', '5200'], 'Ives': ['FB31', 'FB41'], 'Pemko': ['Thresholds', 'Door Bottoms'], 'Other': ['Manual Entry'] }
};

const HardwareCatalog = [
    { id: 'lockset', label: 'Lockset', defaultBrand: 'Schlage', defaultModel: 'ND Series' },
    { id: 'panic-rim', label: 'Panic Bar - Rim', defaultBrand: 'Von Duprin', defaultModel: '98/99' },
    { id: 'panic-cvr', label: 'Panic Bar - CVR', defaultBrand: 'Von Duprin', defaultModel: '22 Series' },
    { id: 'closer', label: 'Door Closer', defaultBrand: 'LCN', defaultModel: '4041' },
    { id: 'hinges', label: 'Hinges (Set)', defaultBrand: 'Hager', defaultModel: '4300' },
    { id: 'flush-manual', label: 'Manual Flush Bolts', defaultBrand: 'Ives', defaultModel: 'FB31' },
    { id: 'flush-auto', label: 'Auto Flush Bolts', defaultBrand: 'Ives', defaultModel: 'FB41' },
    { id: 'cylinder', label: 'IC Cylinder', defaultBrand: 'Best', defaultModel: 'IC Core' },
    { id: 'threshold', label: 'Threshold', defaultBrand: 'Pemko', defaultModel: 'Thresholds' },
    { id: 'stop', label: 'Door Stop', defaultBrand: 'Ives', defaultModel: 'Manual Entry' },
    { id: 'other', label: 'Other Hardware', defaultBrand: 'Other', defaultModel: 'Manual Entry' }
];

const SavedConfigurations = {};

function generateId() { return 'id_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9); }
function formatCurrency(num) { return '$' + parseFloat(num || 0).toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,'); }
function calculateSellPrice(cost, markup) { return (parseFloat(cost) || 0) * (1 + (parseFloat(markup) || 0) / 100); }
function getVal(id) { const el = document.getElementById(id); return el ? el.value : ''; }
function setVal(id, val) { const el = document.getElementById(id); if (el) el.value = val ?? ''; }

function getDoorTypeLabel(type) { const labels = { 'HM-3HR': 'HM 3-Hour Fire', 'HM-90': 'HM 90-Min Fire', 'HM-45': 'HM 45-Min Fire', 'HM-20': 'HM 20-Min Fire', 'HM-STD': 'HM Non-Rated', 'RF': 'RF Shielded', 'STC': 'STC Acoustic', 'WD-PAINT': 'Wood Paint', 'WD-STAIN': 'Wood Stain', 'WD-LAM': 'Wood Laminate' }; return labels[type] || type; }
function getFrameTypeLabel(type) { const labels = { 'KD-DW-16': 'KD Drywall 16ga', 'KD-DW-14': 'KD Drywall 14ga', 'KD-MASONRY': 'KD Masonry', 'KD-EXIST': 'KD Existing', 'WLD-DW': 'Welded Drywall', 'WLD-MASONRY': 'Welded Masonry', 'WLD-CONCRETE': 'Welded Concrete', 'SINGLE': 'Single Frame', 'PAIR': 'Pair Frame', 'SL-1': 'Single+1 Sidelite', 'DBL-EGRESS': 'Double Egress' }; return labels[type] || type; }

function createNewDoor() {
    return { 
        id: generateId(), 
        quantity: 1,
        door: { type: '', typeManual: '', brand: '', brandManual: '', model: '', modelManual: '', width: '', height: '', thickness: '1-3/4', fireRating: 'None', handing: 'LH', swing: 'Inswing', cost: 0, markup: 30, labor: 0 },
        frame: { type: '', typeManual: '', brand: '', brandManual: '', model: '', modelManual: '', material: 'HM-16', anchors: 'Steel-Stud', jambDepth: '4-3/4', prep: 'STD', cost: 0, markup: 30, labor: 0 },
        hardware: [], 
        notes: '',
        // Data Spec Sheets stored with each door
        specs: {
            door: { image: '', notes: '' },
            frame: { image: '', notes: '' },
            hardware: [] // Array of { type, image, notes }
        }
    };
}

function addNewDoor() { AppState.doors.push(createNewDoor()); AppState.activeIndex = AppState.doors.length - 1; renderTabs(); loadDoorToForm(); }
function removeDoor(index) { if (AppState.doors.length === 1) return; AppState.doors.splice(index, 1); AppState.activeIndex = Math.min(AppState.activeIndex, AppState.doors.length - 1); renderTabs(); loadDoorToForm(); }
function switchToDoor(index) { AppState.activeIndex = index; renderTabs(); loadDoorToForm(); }

function renderTabs() {
    const container = document.getElementById('doorTabs');
    container.innerHTML = '';
    const customerName = AppState.job.customerName || 'Customer';
    const jobRef = AppState.job.jobReference || '';
    AppState.doors.forEach((door, idx) => {
        const tab = document.createElement('div'); tab.className = 'tab';
        const btn = document.createElement('button'); btn.className = 'tab-btn' + (idx === AppState.activeIndex ? ' active' : '');
        const label = jobRef ? `${customerName} - ${jobRef}` : customerName;
        btn.textContent = label; btn.onclick = () => switchToDoor(idx);
        tab.appendChild(btn);
        if (AppState.doors.length > 1) { const delBtn = document.createElement('button'); delBtn.className = 'btn btn-danger'; delBtn.textContent = '‚úï'; delBtn.onclick = (e) => { e.stopPropagation(); removeDoor(idx); }; tab.appendChild(delBtn); }
        container.appendChild(tab);
    });
}

function populateBrandDropdown(selectId, category) { const select = document.getElementById(selectId); select.innerHTML = '<option value="">-- Select --</option>'; Object.keys(BrandLibrary[category] || {}).forEach(b => { const opt = document.createElement('option'); opt.value = b; opt.textContent = b; select.appendChild(opt); }); }
function populateModelDropdown(selectId, category, brand) { const select = document.getElementById(selectId); select.innerHTML = '<option value="">-- Select --</option>'; (BrandLibrary[category]?.[brand] || []).forEach(m => { const opt = document.createElement('option'); opt.value = m; opt.textContent = m; select.appendChild(opt); }); }

function loadDoorToForm() {
    const door = AppState.doors[AppState.activeIndex]; if (!door) return;
    
    // Ensure specs object exists
    if (!door.specs) door.specs = { door: { image: '', notes: '' }, frame: { image: '', notes: '' }, hardware: [] };
    
    setVal('estimateNumber', AppState.job.estimateNumber); setVal('estimateDate', AppState.job.estimateDate); setVal('customerName', AppState.job.customerName); setVal('jobReference', AppState.job.jobReference); setVal('jobAddress', AppState.job.jobAddress || ''); setVal('deliveryAddress', AppState.job.deliveryAddress || '');
    setVal('doorQuantity', door.quantity); setVal('doorType', door.door.type); setVal('doorTypeManual', door.door.typeManual || '');
    setVal('doorWidth', door.door.width); setVal('doorHeight', door.door.height); setVal('doorThickness', door.door.thickness);
    setVal('doorFireRating', door.door.fireRating); setVal('doorHanding', door.door.handing); setVal('doorSwing', door.door.swing);
    setVal('doorCost', door.door.cost || ''); setVal('doorMarkup', door.door.markup); setVal('doorLabor', door.door.labor || '');
    populateBrandDropdown('doorBrand', 'doors'); setVal('doorBrand', door.door.brand); setVal('doorBrandManual', door.door.brandManual || '');
    populateModelDropdown('doorModel', 'doors', door.door.brand); setVal('doorModel', door.door.model); setVal('doorModelManual', door.door.modelManual || '');
    toggleManualEntry('doorType', 'doorTypeManual', door.door.type === 'OTHER'); toggleManualEntry('doorBrand', 'doorBrandManual', door.door.brand === 'Other'); toggleManualEntry('doorModel', 'doorModelManual', door.door.model === 'Manual Entry');
    setVal('frameType', door.frame.type); setVal('frameTypeManual', door.frame.typeManual || ''); setVal('frameMaterial', door.frame.material || 'HM-16');
    setVal('frameAnchors', door.frame.anchors); setVal('frameJambDepth', door.frame.jambDepth || '4-3/4'); setVal('framePrep', door.frame.prep || 'STD');
    setVal('frameCost', door.frame.cost || ''); setVal('frameMarkup', door.frame.markup); setVal('frameLabor', door.frame.labor || '');
    populateBrandDropdown('frameBrand', 'frames'); setVal('frameBrand', door.frame.brand); setVal('frameBrandManual', door.frame.brandManual || '');
    populateModelDropdown('frameModel', 'frames', door.frame.brand); setVal('frameModel', door.frame.model); setVal('frameModelManual', door.frame.modelManual || '');
    toggleManualEntry('frameType', 'frameTypeManual', door.frame.type === 'OTHER'); toggleManualEntry('frameBrand', 'frameBrandManual', door.frame.brand === 'Other'); toggleManualEntry('frameModel', 'frameModelManual', door.frame.model === 'Manual Entry');
    renderHardwareList(); 
    setVal('doorNotes', door.notes); 
    updatePriceDisplays(); 
    updateSummary();
    
    // Load Data Specs
    loadDataSpecs();
}

function toggleManualEntry(selectId, inputId, show) { const input = document.getElementById(inputId); if (input) input.style.display = show ? 'block' : 'none'; }

function updateJobInfo() { AppState.job.estimateNumber = getVal('estimateNumber'); AppState.job.estimateDate = getVal('estimateDate'); AppState.job.customerName = getVal('customerName'); AppState.job.jobReference = getVal('jobReference'); AppState.job.jobAddress = getVal('jobAddress'); AppState.job.deliveryAddress = getVal('deliveryAddress'); renderTabs(); updateSummary(); }

function copyJobSiteToDelivery() {
    const checkbox = document.getElementById('sameAsJobSite');
    const deliveryInput = document.getElementById('deliveryAddress');
    const jobAddress = getVal('jobAddress');
    if (checkbox.checked && jobAddress) {
        deliveryInput.value = jobAddress;
        AppState.job.deliveryAddress = jobAddress;
    }
}

function updateDoor() {
    const door = AppState.doors[AppState.activeIndex]; if (!door) return;
    door.quantity = parseInt(getVal('doorQuantity')) || 1;
    // Sync quantity to specs section
    const qtyDisplay = document.getElementById('specQtyDisplay');
    const qtyInput = document.getElementById('specQtyInput');
    if (qtyDisplay) qtyDisplay.textContent = door.quantity;
    if (qtyInput) qtyInput.value = door.quantity;
    
    door.door.type = getVal('doorType'); door.door.typeManual = getVal('doorTypeManual'); door.door.brand = getVal('doorBrand'); door.door.brandManual = getVal('doorBrandManual'); door.door.model = getVal('doorModel'); door.door.modelManual = getVal('doorModelManual');
    door.door.width = getVal('doorWidth'); door.door.height = getVal('doorHeight'); door.door.thickness = getVal('doorThickness'); door.door.fireRating = getVal('doorFireRating'); door.door.handing = getVal('doorHanding'); door.door.swing = getVal('doorSwing');
    door.door.cost = parseFloat(getVal('doorCost')) || 0; door.door.markup = parseFloat(getVal('doorMarkup')) || 0; door.door.labor = parseFloat(getVal('doorLabor')) || 0;
    door.frame.type = getVal('frameType'); door.frame.typeManual = getVal('frameTypeManual'); door.frame.brand = getVal('frameBrand'); door.frame.brandManual = getVal('frameBrandManual'); door.frame.model = getVal('frameModel'); door.frame.modelManual = getVal('frameModelManual');
    door.frame.material = getVal('frameMaterial'); door.frame.anchors = getVal('frameAnchors'); door.frame.jambDepth = getVal('frameJambDepth'); door.frame.prep = getVal('framePrep');
    door.frame.cost = parseFloat(getVal('frameCost')) || 0; door.frame.markup = parseFloat(getVal('frameMarkup')) || 0; door.frame.labor = parseFloat(getVal('frameLabor')) || 0;
    door.notes = getVal('doorNotes'); updatePriceDisplays(); updateSummary(); renderTabs();
    
    // Refresh spec displays
    refreshSpecInfo();
}

function updateQuantity() {
    const door = AppState.doors[AppState.activeIndex];
    if (!door) return;
    door.quantity = parseInt(getVal('doorQuantity')) || 1;
    // Sync quantity to specs section
    const qtyDisplay = document.getElementById('specQtyDisplay');
    const qtyInput = document.getElementById('specQtyInput');
    if (qtyDisplay) qtyDisplay.textContent = door.quantity;
    if (qtyInput) qtyInput.value = door.quantity;
    // Clear specs so they regenerate with new quantity
    door.specs.door.notes = '';
    door.specs.frame.notes = '';
    if (door.specs.hardware) {
        door.specs.hardware.forEach(s => s.notes = '');
    }
    loadDataSpecs();
    updateSummary();
    renderTabs();
}

function refreshSpecInfo() {
    const door = AppState.doors[AppState.activeIndex];
    if (!door) return;
    
    // Always update door spec info with current data
    const doorInfo = generateDoorSpecInfo(door);
    const doorNotesEl = document.getElementById('doorSpecNotes');
    if (doorNotesEl) {
        doorNotesEl.value = doorInfo;
        door.specs.door.notes = doorInfo;
    }
    
    // Always update frame spec info with current data
    const frameInfo = generateFrameSpecInfo(door);
    const frameNotesEl = document.getElementById('frameSpecNotes');
    if (frameNotesEl) {
        frameNotesEl.value = frameInfo;
        door.specs.frame.notes = frameInfo;
    }
    
    // Also refresh hardware specs
    renderHardwareSpecs();
}

// Force regenerate all specs with current order data
function regenerateAllSpecs() {
    const door = AppState.doors[AppState.activeIndex];
    if (!door) return;
    door.specs.door.notes = '';
    door.specs.door.lastGenerated = '';
    door.specs.frame.notes = '';
    door.specs.frame.lastGenerated = '';
    if (door.specs.hardware) {
        door.specs.hardware.forEach(s => { s.notes = ''; });
    }
    loadDataSpecs();
}

function updateDoorType() { 
    const type = getVal('doorType'); 
    const door = AppState.doors[AppState.activeIndex]; 
    if (door) {
        door.door.type = type;
        // Clear door specs so they regenerate with new info
        door.specs.door.notes = '';
    }
    toggleManualEntry('doorType', 'doorTypeManual', type === 'OTHER'); 
    updateDoor();
    loadDataSpecs();
}
function updateDoorBrand() { 
    const brand = getVal('doorBrand'); 
    const door = AppState.doors[AppState.activeIndex]; 
    toggleManualEntry('doorBrand', 'doorBrandManual', brand === 'Other'); 
    populateModelDropdown('doorModel', 'doors', brand); 
    if (door) { 
        door.door.brand = brand; 
        door.door.model = ''; 
        door.specs.door.notes = ''; // Clear to regenerate
    } 
    updateDoor();
    loadDataSpecs();
}
function updateDoorModel() { 
    const door = AppState.doors[AppState.activeIndex];
    if (door) door.specs.door.notes = ''; // Clear to regenerate
    toggleManualEntry('doorModel', 'doorModelManual', getVal('doorModel') === 'Manual Entry'); 
    updateDoor();
    loadDataSpecs();
}
function updateFrameType() { 
    const type = getVal('frameType'); 
    const door = AppState.doors[AppState.activeIndex]; 
    if (door) {
        door.frame.type = type;
        // Clear frame specs so they regenerate with new info
        door.specs.frame.notes = '';
    }
    toggleManualEntry('frameType', 'frameTypeManual', type === 'OTHER'); 
    updateDoor();
    loadDataSpecs();
}
function updateFrameBrand() { 
    const brand = getVal('frameBrand'); 
    const door = AppState.doors[AppState.activeIndex]; 
    toggleManualEntry('frameBrand', 'frameBrandManual', brand === 'Other'); 
    populateModelDropdown('frameModel', 'frames', brand); 
    if (door) { 
        door.frame.brand = brand; 
        door.frame.model = ''; 
        door.specs.frame.notes = ''; // Clear to regenerate
    } 
    updateDoor();
    loadDataSpecs();
}
function updateFrameModel() { 
    const door = AppState.doors[AppState.activeIndex];
    if (door) door.specs.frame.notes = ''; // Clear to regenerate
    toggleManualEntry('frameModel', 'frameModelManual', getVal('frameModel') === 'Manual Entry'); 
    updateDoor();
    loadDataSpecs();
}
function updatePriceDisplays() { const door = AppState.doors[AppState.activeIndex]; if (!door) return; setVal('doorSellPrice', formatCurrency(calculateSellPrice(door.door.cost, door.door.markup))); setVal('frameSellPrice', formatCurrency(calculateSellPrice(door.frame.cost, door.frame.markup))); }

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// DATA SPECS FUNCTIONS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function loadDataSpecs() {
    const door = AppState.doors[AppState.activeIndex];
    if (!door || !door.specs) return;
    
    // Update quantity display in specs section
    const qtyDisplay = document.getElementById('specQtyDisplay');
    const qtyInput = document.getElementById('specQtyInput');
    if (qtyDisplay) qtyDisplay.textContent = door.quantity;
    if (qtyInput) qtyInput.value = door.quantity;
    
    // Generate Door spec info from actual selections - always show current data
    const doorInfo = generateDoorSpecInfo(door);
    const doorImgArea = document.getElementById('doorSpecImage');
    if (doorImgArea) {
        if (door.specs.door.image) {
            doorImgArea.innerHTML = `<img src="${door.specs.door.image}">`;
            doorImgArea.classList.remove('empty');
            doorImgArea.onclick = () => { if(confirm('Remove image?')) { door.specs.door.image = ''; loadDataSpecs(); } };
        } else {
            doorImgArea.innerHTML = 'Click to upload image';
            doorImgArea.classList.add('empty');
            doorImgArea.onclick = () => document.getElementById('doorSpecImageInput').click();
        }
    }
    const doorNotesEl = document.getElementById('doorSpecNotes');
    if (doorNotesEl) {
        door.specs.door.notes = doorInfo;
        doorNotesEl.value = doorInfo;
    }
    
    // Generate Frame spec info from actual selections - always show current data
    const frameInfo = generateFrameSpecInfo(door);
    const frameImgArea = document.getElementById('frameSpecImage');
    if (frameImgArea) {
        if (door.specs.frame.image) {
            frameImgArea.innerHTML = `<img src="${door.specs.frame.image}">`;
            frameImgArea.classList.remove('empty');
            frameImgArea.onclick = () => { if(confirm('Remove image?')) { door.specs.frame.image = ''; loadDataSpecs(); } };
        } else {
            frameImgArea.innerHTML = 'Click to upload image';
            frameImgArea.classList.add('empty');
            frameImgArea.onclick = () => document.getElementById('frameSpecImageInput').click();
        }
    }
    const frameNotesEl = document.getElementById('frameSpecNotes');
    if (frameNotesEl) {
        door.specs.frame.notes = frameInfo;
        frameNotesEl.value = frameInfo;
    }
    
    // Hardware specs
    renderHardwareSpecs();
}

function generateDoorSpecInfo(door) {
    let info = [];
    // Always show quantity first
    info.push(`QTY: ${door.quantity}`);
    // Door type
    info.push(`DOOR TYPE: ${door.door.type ? (door.door.type === 'OTHER' ? door.door.typeManual : getDoorTypeLabel(door.door.type)) : '‚Äî'}`);
    // Door dimensions - clearly labeled as DOOR
    info.push(`DOOR WIDTH: ${door.door.width ? door.door.width + '"' : '‚Äî'}`);
    info.push(`DOOR HEIGHT: ${door.door.height ? door.door.height + '"' : '‚Äî'}`);
    info.push(`DOOR THICKNESS: ${door.door.thickness ? door.door.thickness + '"' : '‚Äî'}`);
    // Brand/Model
    const brand = door.door.brand === 'Other' ? door.door.brandManual : door.door.brand;
    const model = door.door.model === 'Manual Entry' ? door.door.modelManual : door.door.model;
    info.push(`DOOR BRAND: ${brand || '‚Äî'}`);
    info.push(`DOOR MODEL: ${model || '‚Äî'}`);
    // Fire rating
    info.push(`FIRE RATING: ${door.door.fireRating && door.door.fireRating !== 'None' ? door.door.fireRating : '‚Äî'}`);
    // Handing and swing
    info.push(`HANDING: ${door.door.handing || '‚Äî'}`);
    info.push(`SWING: ${door.door.swing || '‚Äî'}`);
    
    return info.join('\n');
}

function generateFrameSpecInfo(door) {
    let info = [];
    // Always show quantity first
    info.push(`QTY: ${door.quantity}`);
    // Frame type
    info.push(`FRAME TYPE: ${door.frame.type ? (door.frame.type === 'OTHER' ? door.frame.typeManual : getFrameTypeLabel(door.frame.type)) : '‚Äî'}`);
    // Frame material
    const matLabels = { 'HM-16': '16 Ga. Hollow Metal', 'HM-14': '14 Ga. Hollow Metal', 'HM-12': '12 Ga. Hollow Metal', 'WD': 'Wood', 'AL': 'Aluminum', 'SS': 'Stainless Steel' };
    info.push(`FRAME MATERIAL: ${door.frame.material ? (matLabels[door.frame.material] || door.frame.material) : '‚Äî'}`);
    // Brand/Model
    const brand = door.frame.brand === 'Other' ? door.frame.brandManual : door.frame.brand;
    const model = door.frame.model === 'Manual Entry' ? door.frame.modelManual : door.frame.model;
    info.push(`FRAME BRAND: ${brand || '‚Äî'}`);
    info.push(`FRAME MODEL: ${model || '‚Äî'}`);
    // Jamb depth
    info.push(`JAMB DEPTH: ${door.frame.jambDepth ? door.frame.jambDepth + '"' : '‚Äî'}`);
    // Anchors
    const anchorLabels = { 'Steel-Stud': 'Steel Stud Anchor', 'Wood-Stud': 'Wood Stud Anchor', 'Masonry': 'Masonry Anchor', 'Masonry-T': 'Masonry T-Anchor', 'Compression': 'Compression Anchor', 'Existing': 'Existing Opening' };
    info.push(`ANCHORS: ${door.frame.anchors ? (anchorLabels[door.frame.anchors] || door.frame.anchors) : '‚Äî'}`);
    // Prep
    const prepLabels = { 'STD': 'Standard (161)', 'MORTISE': 'Mortise Lock', 'DEADBOLT': 'Deadbolt', 'EXIT': 'Exit Device', 'ELECTRIC': 'Electric Strike', 'ELEC': 'Electric Strike', 'NONE': 'No Prep' };
    info.push(`HEAD/STRIKE PREP: ${door.frame.prep ? (prepLabels[door.frame.prep] || door.frame.prep) : '‚Äî'}`);
    
    return info.join('\n');
}

function generateHardwareSpecInfo(hw) {
    if (!hw) return '';
    
    let info = [];
    // Always show quantity first
    info.push(`QTY: ${hw.qty || 1}`);
    info.push(`ITEM: ${hw.label || hw.type || '‚Äî'}`);
    // Brand/Model
    const brand = hw.brand === 'Other' ? hw.brandManual : hw.brand;
    const model = hw.model === 'Manual Entry' ? hw.modelManual : hw.model;
    info.push(`BRAND: ${brand || '‚Äî'}`);
    info.push(`MODEL: ${model || '‚Äî'}`);
    
    return info.join('\n');
}

function updateQtyFromSpecs(qty) {
    const door = AppState.doors[AppState.activeIndex];
    if (!door) return;
    door.quantity = parseInt(qty) || 1;
    setVal('doorQuantity', door.quantity);
    document.getElementById('specQtyDisplay').textContent = door.quantity;
    // Clear specs so they regenerate with new quantity
    door.specs.door.notes = '';
    door.specs.frame.notes = '';
    if (door.specs.hardware) {
        door.specs.hardware.forEach(s => s.notes = '');
    }
    loadDataSpecs();
    updateSummary();
    renderTabs();
}

function renderHardwareSpecs() {
    const door = AppState.doors[AppState.activeIndex];
    const container = document.getElementById('hardwareSpecsContainer');
    if (!container) return;
    if (!door || !door.hardware || door.hardware.length === 0) {
        container.innerHTML = '<p style="color:#9ca3af; text-align:center; padding:15px; font-size:12px;">No hardware added. Click "+ Add Hardware" above to add hardware items.</p>';
        return;
    }
    
    // Ensure specs.hardware array matches hardware array
    if (!door.specs.hardware) door.specs.hardware = [];
    while (door.specs.hardware.length < door.hardware.length) {
        door.specs.hardware.push({ image: '', notes: '' });
    }
    
    container.innerHTML = door.hardware.map((hw, idx) => {
        const spec = door.specs.hardware[idx] || { image: '', notes: '' };
        const hasImage = spec.image ? true : false;
        
        // Always generate hardware info from current data
        const hwInfo = generateHardwareSpecInfo(hw);
        spec.notes = hwInfo;
        door.specs.hardware[idx].notes = hwInfo;
        
        return `
        <div class="spec-item">
            <div class="spec-item-header">
                <span class="spec-item-title">${hw.label || hw.type}</span>
            </div>
            <div class="spec-item-content">
                <div class="spec-image-area ${hasImage ? '' : 'empty'}" id="hwSpecImage-${idx}" onclick="handleHwSpecImageClick(${idx}, ${hasImage})">
                    ${hasImage ? `<img src="${spec.image}">` : 'Click to upload image'}
                </div>
                <input type="file" id="hwSpecImageInput-${idx}" accept="image/*" style="display:none" onchange="handleHwSpecImageUpload(${idx}, event)">
                <div class="spec-notes">
                    <textarea id="hwSpecNotes-${idx}" placeholder="Hardware specifications..." onchange="updateHwSpecNotes(${idx})">${hwInfo}</textarea>
                </div>
            </div>
        </div>`;
    }).join('');
}

function handleHwSpecImageClick(idx, hasImage) {
    if (hasImage) {
        removeHwSpecImage(idx);
    } else {
        document.getElementById('hwSpecImageInput-' + idx).click();
    }
}

function handleSpecImageUpload(type, event) {
    const file = event.target.files[0];
    if (!file) return;
    const door = AppState.doors[AppState.activeIndex];
    if (!door) return;
    
    const reader = new FileReader();
    reader.onload = function(e) {
        door.specs[type].image = e.target.result;
        loadDataSpecs();
    };
    reader.readAsDataURL(file);
    event.target.value = '';
}

function updateSpecNotes(type) {
    const door = AppState.doors[AppState.activeIndex];
    if (!door) return;
    door.specs[type].notes = getVal(type + 'SpecNotes');
}

function handleHwSpecImageUpload(idx, event) {
    const file = event.target.files[0];
    if (!file) return;
    const door = AppState.doors[AppState.activeIndex];
    if (!door) return;
    
    const reader = new FileReader();
    reader.onload = function(e) {
        if (!door.specs.hardware[idx]) door.specs.hardware[idx] = { image: '', notes: '' };
        door.specs.hardware[idx].image = e.target.result;
        renderHardwareSpecs();
    };
    reader.readAsDataURL(file);
    event.target.value = '';
}

function removeHwSpecImage(idx) {
    if (!confirm('Remove image?')) return;
    const door = AppState.doors[AppState.activeIndex];
    if (door && door.specs.hardware[idx]) {
        door.specs.hardware[idx].image = '';
        renderHardwareSpecs();
    }
}

function updateHwSpecNotes(idx) {
    const door = AppState.doors[AppState.activeIndex];
    if (!door) return;
    if (!door.specs.hardware[idx]) door.specs.hardware[idx] = { image: '', notes: '' };
    door.specs.hardware[idx].notes = getVal('hwSpecNotes-' + idx);
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// HARDWARE MANAGEMENT
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function renderHardwareList() {
    const door = AppState.doors[AppState.activeIndex]; const container = document.getElementById('hardwareList');
    if (!door.hardware || door.hardware.length === 0) { container.innerHTML = '<div style="padding:20px;text-align:center;color:#9ca3af;">No hardware. Click "+ Add Hardware"</div>'; return; }
    container.innerHTML = door.hardware.map((hw, idx) => `
        <div class="hardware-item">
            <div class="hardware-item-header"><span class="hardware-item-title">${hw.label || 'Hardware'}</span><button class="btn btn-danger btn-sm" onclick="removeHardwareItem(${idx})">Remove</button></div>
            <div class="form-row">
                <div class="form-group"><label>Type</label><select onchange="updateHardwareType(${idx}, this.value)">${HardwareCatalog.map(h => `<option value="${h.id}" ${hw.type === h.id ? 'selected' : ''}>${h.label}</option>`).join('')}</select></div>
                <div class="form-group"><label>Brand</label><select id="hwBrand-${idx}" onchange="updateHardwareBrand(${idx}, this.value)"><option value="">-- Select --</option>${Object.keys(BrandLibrary.hardware).map(b => `<option value="${b}" ${hw.brand === b ? 'selected' : ''}>${b}</option>`).join('')}</select><input type="text" id="hwBrandManual-${idx}" placeholder="Brand..." style="display:${hw.brand === 'Other' ? 'block' : 'none'}; margin-top:6px;" value="${hw.brandManual || ''}" onchange="updateHardwareBrandManual(${idx}, this.value)"></div>
                <div class="form-group"><label>Model</label><select id="hwModel-${idx}" onchange="updateHardwareModel(${idx}, this.value)"><option value="">-- Select --</option>${(BrandLibrary.hardware[hw.brand] || []).map(m => `<option value="${m}" ${hw.model === m ? 'selected' : ''}>${m}</option>`).join('')}</select><input type="text" id="hwModelManual-${idx}" placeholder="Model..." style="display:${hw.model === 'Manual Entry' ? 'block' : 'none'}; margin-top:6px;" value="${hw.modelManual || ''}" onchange="updateHardwareModelManual(${idx}, this.value)"></div>
                <div class="form-group"><label>Qty</label><input type="number" value="${hw.qty || 1}" min="1" onchange="updateHardwareQty(${idx}, this.value)"></div>
            </div>
            <div class="pricing-row">
                <div class="form-group"><label>Cost</label><input type="number" class="cost-input" value="${hw.cost || ''}" step="0.01" onchange="updateHardwareCost(${idx}, this.value)"></div>
                <div class="form-group"><label>Markup %</label><input type="number" class="markup-input" value="${hw.markup || 30}" onchange="updateHardwareMarkup(${idx}, this.value)"></div>
                <div class="form-group"><label>Sell</label><input type="text" class="sell-price" value="${formatCurrency(calculateSellPrice(hw.cost, hw.markup))}" readonly></div>
                <div class="form-group"><label>Labor</label><input type="number" class="labor-input" value="${hw.labor || ''}" step="0.01" onchange="updateHardwareLabor(${idx}, this.value)"></div>
            </div>
        </div>`).join('');
    
    // Also update hardware specs
    renderHardwareSpecs();
}

function addHardwareItem() { 
    const door = AppState.doors[AppState.activeIndex]; 
    const def = HardwareCatalog[0]; 
    door.hardware.push({ type: def.id, label: def.label, brand: def.defaultBrand, brandManual: '', model: def.defaultModel, modelManual: '', qty: 1, cost: 0, markup: 30, labor: 0 }); 
    // Add corresponding spec entry (blank - user fills in)
    if (!door.specs.hardware) door.specs.hardware = [];
    door.specs.hardware.push({ image: '', notes: '' });
    renderHardwareList(); 
    updateSummary(); 
}

function removeHardwareItem(idx) { 
    const door = AppState.doors[AppState.activeIndex];
    door.hardware.splice(idx, 1); 
    // Also remove spec
    if (door.specs.hardware && door.specs.hardware[idx]) {
        door.specs.hardware.splice(idx, 1);
    }
    renderHardwareList(); 
    updateSummary(); 
}

function updateHardwareType(idx, typeId) { 
    const door = AppState.doors[AppState.activeIndex]; 
    const item = HardwareCatalog.find(h => h.id === typeId); 
    door.hardware[idx].type = typeId; 
    door.hardware[idx].label = item?.label || typeId; 
    door.hardware[idx].brand = item?.defaultBrand || ''; 
    door.hardware[idx].model = item?.defaultModel || ''; 
    if (!door.specs.hardware[idx]) door.specs.hardware[idx] = { image: '', notes: '' };
    // Clear notes so they regenerate with new info
    door.specs.hardware[idx].notes = '';
    renderHardwareList(); 
    renderHardwareSpecs();
    updateSummary(); 
}
function updateHardwareBrand(idx, brand) { 
    const door = AppState.doors[AppState.activeIndex]; 
    door.hardware[idx].brand = brand; 
    door.hardware[idx].model = ''; 
    if (door.specs.hardware[idx]) door.specs.hardware[idx].notes = '';
    renderHardwareList(); 
    renderHardwareSpecs();
    updateSummary(); 
}
function updateHardwareBrandManual(idx, val) { 
    const door = AppState.doors[AppState.activeIndex];
    door.hardware[idx].brandManual = val; 
    if (door.specs.hardware[idx]) door.specs.hardware[idx].notes = '';
    renderHardwareSpecs();
    updateSummary(); 
}
function updateHardwareModel(idx, model) { 
    const door = AppState.doors[AppState.activeIndex];
    door.hardware[idx].model = model; 
    const mi = document.getElementById(`hwModelManual-${idx}`); 
    if (mi) mi.style.display = model === 'Manual Entry' ? 'block' : 'none'; 
    if (!door.specs.hardware[idx]) door.specs.hardware[idx] = { image: '', notes: '' };
    // Clear notes so they regenerate with new info
    door.specs.hardware[idx].notes = '';
    renderHardwareSpecs();
    updateSummary(); 
}
function updateHardwareModelManual(idx, val) { 
    const door = AppState.doors[AppState.activeIndex];
    door.hardware[idx].modelManual = val; 
    if (door.specs.hardware[idx]) door.specs.hardware[idx].notes = '';
    renderHardwareSpecs();
    updateSummary(); 
}
function updateHardwareQty(idx, qty) { 
    const door = AppState.doors[AppState.activeIndex];
    door.hardware[idx].qty = parseInt(qty) || 1; 
    if (door.specs.hardware[idx]) door.specs.hardware[idx].notes = '';
    renderHardwareSpecs();
    updateSummary(); 
}
function updateHardwareCost(idx, cost) { AppState.doors[AppState.activeIndex].hardware[idx].cost = parseFloat(cost) || 0; renderHardwareList(); updateSummary(); }
function updateHardwareMarkup(idx, markup) { AppState.doors[AppState.activeIndex].hardware[idx].markup = parseFloat(markup) || 0; renderHardwareList(); updateSummary(); }
function updateHardwareLabor(idx, labor) { AppState.doors[AppState.activeIndex].hardware[idx].labor = parseFloat(labor) || 0; updateSummary(); }

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// SUMMARY
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function updateSummary() {
    const door = AppState.doors[AppState.activeIndex]; const container = document.getElementById('summaryContent');
    const customerName = AppState.job.customerName || 'Customer';
    const jobRef = AppState.job.jobReference || '';
    document.getElementById('summaryDoorLabel').textContent = customerName;
    document.getElementById('summaryJobRef').textContent = jobRef;
    document.getElementById('qtyMultiplier').textContent = door.quantity;
    const items = []; let materialsTotal = 0, laborTotal = 0;
    if (door.door.type || door.door.width) { const doorSell = calculateSellPrice(door.door.cost, door.door.markup); materialsTotal += doorSell; laborTotal += door.door.labor;
        const typeDisp = door.door.type === 'OTHER' ? door.door.typeManual : getDoorTypeLabel(door.door.type); const brandDisp = door.door.brand === 'Other' ? door.door.brandManual : door.door.brand;
        items.push({ category: 'DOOR', name: `${typeDisp || 'Door'}${brandDisp ? ' ‚Äì ' + brandDisp : ''}`, details: `${door.door.width || '?'}" √ó ${door.door.height || '?'}" | ${door.door.fireRating}`, price: doorSell, labor: door.door.labor }); }
    if (door.frame.type) { const frameSell = calculateSellPrice(door.frame.cost, door.frame.markup); materialsTotal += frameSell; laborTotal += door.frame.labor;
        const typeDisp = door.frame.type === 'OTHER' ? door.frame.typeManual : getFrameTypeLabel(door.frame.type); const brandDisp = door.frame.brand === 'Other' ? door.frame.brandManual : door.frame.brand;
        items.push({ category: 'FRAME', name: `${typeDisp || 'Frame'}${brandDisp ? ' ‚Äì ' + brandDisp : ''}`, details: `${door.frame.material} | ${door.frame.anchors}`, price: frameSell, labor: door.frame.labor }); }
    door.hardware.forEach(hw => { const hwSell = calculateSellPrice(hw.cost, hw.markup) * (hw.qty || 1); const hwLabor = (hw.labor || 0) * (hw.qty || 1); materialsTotal += hwSell; laborTotal += hwLabor;
        const brandDisp = hw.brand === 'Other' ? hw.brandManual : hw.brand;
        items.push({ category: 'HARDWARE', name: `${hw.label || hw.type}${brandDisp ? ' ‚Äì ' + brandDisp : ''}`, details: hw.qty > 1 ? `Qty: ${hw.qty}` : '', price: hwSell, labor: hwLabor }); });
    container.innerHTML = items.map(i => `<div class="summary-item"><div class="summary-category">${i.category}</div><div class="summary-item-name">${i.name}</div>${i.details ? `<div class="summary-details">${i.details}</div>` : ''}${i.price > 0 ? `<div class="summary-price">Mat: ${formatCurrency(i.price)}${i.labor > 0 ? ' | Lab: ' + formatCurrency(i.labor) : ''}</div>` : ''}</div>`).join('');
    const doorTotal = (materialsTotal + laborTotal) * door.quantity;
    document.getElementById('materialsSubtotal').textContent = formatCurrency(materialsTotal); document.getElementById('laborSubtotal').textContent = formatCurrency(laborTotal); document.getElementById('doorTotal').textContent = formatCurrency(doorTotal);
    let grandTotal = 0; AppState.doors.forEach(d => { let dMat = calculateSellPrice(d.door.cost, d.door.markup) + calculateSellPrice(d.frame.cost, d.frame.markup), dLab = (d.door.labor || 0) + (d.frame.labor || 0);
        d.hardware.forEach(hw => { dMat += calculateSellPrice(hw.cost, hw.markup) * (hw.qty || 1); dLab += (hw.labor || 0) * (hw.qty || 1); }); grandTotal += (dMat + dLab) * d.quantity; });
    document.getElementById('grandTotal').textContent = formatCurrency(grandTotal);
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// SPEC SHEET GENERATION (with images and notes)
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function generateCleanSpecSheetHTML() {
    const job = AppState.job;
    let grandTotal = 0, totalMaterials = 0, totalLabor = 0;
    
    // Collect specs data for second section
    let allSpecs = [];
    
    let html = `<!DOCTYPE html>
<html><head><meta charset="UTF-8"><title>Aloha Doors - ${job.estimateNumber || 'Spec Sheet'}</title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body { 
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
    font-size: 11px; 
    padding: 0; 
    max-width: 850px; 
    margin: 0 auto; 
    background: white;
    color: #333;
}

/* Header - Compact */
.main-header {
    background: linear-gradient(135deg, #8B0000 0%, #c41e3a 100%);
    color: white;
    padding: 15px 25px;
    margin-bottom: 0;
}
.header-content {
    display: flex;
    justify-content: space-between;
    align-items: center;
}
.company-name {
    font-size: 26px;
    font-weight: 700;
    letter-spacing: 3px;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
}
.company-tagline {
    font-size: 9px;
    letter-spacing: 2px;
    opacity: 0.9;
    margin-top: 2px;
}
.doc-info {
    text-align: right;
    font-size: 10px;
    line-height: 1.4;
}
.doc-info strong {
    color: #ffd700;
}
.estimate-number {
    font-size: 14px;
    font-weight: 700;
    background: rgba(255,255,255,0.15);
    padding: 5px 12px;
    border-radius: 4px;
    margin-bottom: 5px;
    display: inline-block;
}

/* Customer Banner - Compact */
.customer-banner {
    background: #1a1a2e;
    color: white;
    padding: 8px 25px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}
.customer-name {
    font-size: 13px;
    font-weight: 600;
}
.job-ref {
    font-size: 10px;
    opacity: 0.8;
}

/* Content Area - Compact */
.content {
    padding: 12px 20px;
}

/* Door Section - Compact */
.door-section {
    margin-bottom: 10px;
    border: 1px solid #ddd;
    border-radius: 6px;
    overflow: hidden;
    box-shadow: 0 1px 4px rgba(0,0,0,0.06);
}
.door-header {
    background: linear-gradient(135deg, #2c3e50, #3498db);
    color: white;
    padding: 6px 15px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}
.door-title {
    font-size: 12px;
    font-weight: 700;
}
.door-qty {
    background: #ffd700;
    color: #1a1a2e;
    padding: 3px 12px;
    border-radius: 12px;
    font-weight: 700;
    font-size: 11px;
}
.door-content {
    padding: 0;
}

/* Table Styling - Compact */
table {
    width: 100%;
    border-collapse: collapse;
}
th {
    background: #f8f9fa;
    color: #333;
    padding: 5px 8px;
    text-align: left;
    font-size: 8px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    border-bottom: 2px solid #8B0000;
}
td {
    padding: 6px 8px;
    border-bottom: 1px solid #eee;
    font-size: 9px;
    vertical-align: middle;
}
tr:hover { background: #fafafa; }
.component-label {
    font-weight: 700;
    color: #8B0000;
    font-size: 8px;
    text-transform: uppercase;
    letter-spacing: 0.3px;
}
.type-value {
    font-weight: 600;
    color: #333;
}
.brand-value {
    color: #666;
    font-size: 9px;
}
.specs-value {
    font-size: 8px;
    color: #555;
    line-height: 1.3;
}
.price-cell {
    text-align: right;
    font-weight: 600;
    font-family: 'Courier New', monospace;
    font-size: 9px;
}
.subtotal-row {
    background: linear-gradient(135deg, #f0f0f0, #e8e8e8);
}
.subtotal-row td {
    font-weight: 700;
    border-bottom: none;
    padding: 8px;
    font-size: 9px;
}

/* Notes - Compact */
.notes-box {
    background: linear-gradient(135deg, #fff8e1, #ffecb3);
    border-left: 3px solid #ffc107;
    padding: 6px 10px;
    margin: 0;
    font-size: 9px;
}
.notes-box strong {
    color: #ff8f00;
}

/* Totals - Compact */
.totals-section {
    margin-top: 15px;
    border-radius: 6px;
    overflow: hidden;
    box-shadow: 0 1px 4px rgba(0,0,0,0.1);
}
.totals-header {
    background: linear-gradient(135deg, #1a1a2e, #16213e);
    color: white;
    padding: 8px 15px;
    font-size: 11px;
    font-weight: 700;
    letter-spacing: 1px;
}
.totals-table {
    width: 100%;
}
.totals-table td {
    padding: 8px 15px;
    font-size: 11px;
}
.totals-table tr:last-child {
    background: linear-gradient(135deg, #8B0000, #c41e3a);
    color: white;
}
.totals-table tr:last-child td {
    font-size: 14px;
    font-weight: 700;
    padding: 10px 15px;
}
.totals-label {
    font-weight: 600;
}
.totals-amount {
    text-align: right;
    font-family: 'Courier New', monospace;
    font-weight: 700;
}

/* Footer - Compact */
.footer {
    text-align: center;
    margin-top: 15px;
    padding: 10px;
    border-top: 2px solid #8B0000;
    color: #666;
    font-size: 9px;
}
.footer-logo {
    font-size: 11px;
    font-weight: 700;
    color: #8B0000;
    margin-bottom: 2px;
}

/* Page Break */
.page-break {
    page-break-before: always;
    margin-top: 0;
}

/* Specifications Section */
.specs-page-header {
    background: linear-gradient(135deg, #1565c0, #1976d2);
    color: white;
    padding: 20px 30px;
    margin-bottom: 0;
}
.specs-page-title {
    font-size: 24px;
    font-weight: 700;
    letter-spacing: 2px;
}
.specs-page-subtitle {
    font-size: 11px;
    opacity: 0.9;
    margin-top: 5px;
}

.spec-door-section {
    margin-bottom: 30px;
    border: 2px solid #1565c0;
    border-radius: 10px;
    overflow: hidden;
}
.spec-door-header {
    background: linear-gradient(135deg, #2c3e50, #3498db);
    color: white;
    padding: 15px 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}
.spec-door-title {
    font-size: 18px;
    font-weight: 700;
}
.spec-door-qty {
    background: #ffd700;
    color: #1a1a2e;
    padding: 8px 20px;
    border-radius: 20px;
    font-weight: 700;
    font-size: 16px;
}

.category-header {
    background: #8B0000;
    color: white;
    padding: 8px 20px;
    font-weight: 700;
    font-size: 14px;
    letter-spacing: 1px;
}

.spec-card {
    background: #fafafa;
    padding: 15px 20px;
}
.spec-card-title {
    font-weight: 700;
    color: #333;
    font-size: 14px;
    margin-bottom: 12px;
    padding-bottom: 8px;
    border-bottom: 2px solid #8B0000;
}
.spec-grid {
    display: flex;
    gap: 20px;
    align-items: flex-start;
}
.spec-image {
    flex-shrink: 0;
}
.spec-image img {
    max-width: 320px;
    max-height: 280px;
    border: 3px solid #333;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
}
.spec-details {
    flex: 1;
    font-size: 11px;
    line-height: 1.7;
    white-space: pre-line;
    color: #333;
    background: white;
    padding: 12px;
    border-radius: 8px;
    border: 1px solid #e0e0e0;
}

/* Spec Page Header - Compact */
.spec-page-header {
    background: linear-gradient(135deg, #1565c0, #1976d2);
    color: white;
    padding: 12px 25px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}
.spec-page-info {
    text-align: right;
    font-size: 11px;
}
.spec-page-badge {
    background: #ffd700;
    color: #1a1a2e;
    padding: 5px 15px;
    border-radius: 15px;
    font-weight: 700;
    font-size: 13px;
    display: inline-block;
    margin-bottom: 5px;
}

/* Compact customer banner for spec pages */
.spec-customer-banner {
    background: #1a1a2e;
    color: white;
    padding: 10px 25px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 12px;
}

/* Compact content area for spec pages */
.spec-content {
    padding: 15px 25px;
}

/* Compact footer for spec pages */
.spec-footer {
    text-align: center;
    padding: 10px;
    border-top: 2px solid #8B0000;
    color: #666;
    font-size: 9px;
}

@media print {
    body { padding: 0; }
    @page { margin: 0.3in; }
    .door-section { page-break-inside: avoid; }
    .spec-page { page-break-before: always; page-break-inside: avoid; }
    .page-break { page-break-before: always; }
}
</style></head><body>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<!-- PAGE 1: INVOICE / PRICING -->
<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->

<div class="main-header">
    <div class="header-content">
        <div class="company-info">
            <img src="data:image/webp;base64,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" alt="Aloha Doors" style="height: 45px;">
            <div style="font-size: 10px; color: #666; margin-top: 5px;">214 Main St. #119, El Segundo CA 90245 ‚Ä¢ (310) 414-0488 ‚Ä¢ alohadoors.com</div>
        </div>
        <div class="doc-info">
            <div class="estimate-number">${job.estimateNumber || 'ESTIMATE'}</div>
            <div><strong>Date:</strong> ${job.estimateDate || new Date().toLocaleDateString()}</div>
        </div>
    </div>
</div>

<div class="customer-banner">
    <div>
        <div class="customer-name">${job.customerName || 'Customer'}</div>
        ${job.jobAddress ? `<div class="job-ref">${job.jobAddress}</div>` : ''}
        ${job.jobReference ? `<div class="job-ref">Ref: ${job.jobReference}</div>` : ''}
    </div>
    <div style="font-size: 10px; text-align: right;">
        ${job.deliveryAddress ? `<div><strong>Deliver To:</strong> ${job.deliveryAddress}</div>` : ''}
        <div><strong>${AppState.doors.length}</strong> Door Config${AppState.doors.length > 1 ? 's' : ''}</div>
    </div>
</div>

<div class="content">`;

    // FIRST PASS: Output pricing tables only
    AppState.doors.forEach((door, idx) => {
        let doorMaterials = 0, doorLabor = 0;
        const doorSell = calculateSellPrice(door.door.cost, door.door.markup);
        const frameSell = calculateSellPrice(door.frame.cost, door.frame.markup);
        doorMaterials += doorSell + frameSell;
        doorLabor += (door.door.labor || 0) + (door.frame.labor || 0);
        
        const doorType = door.door.type === 'OTHER' ? door.door.typeManual : getDoorTypeLabel(door.door.type);
        const doorBrand = door.door.brand === 'Other' ? door.door.brandManual : door.door.brand;
        const doorModel = door.door.model === 'Manual Entry' ? door.door.modelManual : door.door.model;
        const frameType = door.frame.type === 'OTHER' ? door.frame.typeManual : getFrameTypeLabel(door.frame.type);
        const frameBrand = door.frame.brand === 'Other' ? door.frame.brandManual : door.frame.brand;
        const frameModel = door.frame.model === 'Manual Entry' ? door.frame.modelManual : door.frame.model;
        const customerName = job.customerName || '';
        const doorLabel = customerName ? `${customerName} - Door ${idx + 1}` : `Door #${idx + 1}`;
        
        html += `
<div class="door-section">
    <div class="door-header">
        <span class="door-title">${doorLabel}</span>
        <span class="door-qty">QTY: ${door.quantity}</span>
    </div>
    <div class="door-content">
        <table>
            <tr>
                <th style="width:12%">Component</th>
                <th style="width:18%">Type</th>
                <th style="width:20%">Brand / Model</th>
                <th style="width:30%">Specifications</th>
                <th style="width:10%">Material</th>
                <th style="width:10%">Labor</th>
            </tr>
            <tr>
                <td><span class="component-label">üö™ Door</span></td>
                <td class="type-value">${doorType || '‚Äî'}</td>
                <td class="brand-value">${doorBrand || '‚Äî'}${doorModel ? '<br/>' + doorModel : ''}</td>
                <td class="specs-value">${door.door.width || '‚Äî'}" W √ó ${door.door.height || '‚Äî'}" H √ó ${door.door.thickness}"<br/>Fire: ${door.door.fireRating || 'None'} | ${door.door.handing || 'LH'} | ${door.door.swing || 'Inswing'}</td>
                <td class="price-cell">${formatCurrency(doorSell)}</td>
                <td class="price-cell">${formatCurrency(door.door.labor)}</td>
            </tr>
            <tr>
                <td><span class="component-label">üî≤ Frame</span></td>
                <td class="type-value">${frameType || '‚Äî'}</td>
                <td class="brand-value">${frameBrand || '‚Äî'}${frameModel ? '<br/>' + frameModel : ''}</td>
                <td class="specs-value">${door.frame.material || 'HM-16'} | ${door.frame.anchors || 'Steel-Stud'}<br/>Jamb: ${door.frame.jambDepth || '4-3/4'}" | Prep: ${door.frame.prep || 'STD'}</td>
                <td class="price-cell">${formatCurrency(frameSell)}</td>
                <td class="price-cell">${formatCurrency(door.frame.labor)}</td>
            </tr>`;

        door.hardware.forEach((hw, hIdx) => {
            const hwSell = calculateSellPrice(hw.cost, hw.markup) * (hw.qty || 1);
            const hwLabor = (hw.labor || 0) * (hw.qty || 1);
            doorMaterials += hwSell;
            doorLabor += hwLabor;
            const hwBrand = hw.brand === 'Other' ? hw.brandManual : hw.brand;
            const hwModel = hw.model === 'Manual Entry' ? hw.modelManual : hw.model;
            html += `
            <tr>
                <td><span class="component-label">üîß Hardware</span></td>
                <td class="type-value">${hw.label || hw.type}${hw.qty > 1 ? ' <small>(√ó' + hw.qty + ')</small>' : ''}</td>
                <td class="brand-value">${hwBrand || '‚Äî'}${hwModel ? '<br/>' + hwModel : ''}</td>
                <td class="specs-value"></td>
                <td class="price-cell">${formatCurrency(hwSell)}</td>
                <td class="price-cell">${formatCurrency(hwLabor)}</td>
            </tr>`;
        });
        
        const openingTotal = (doorMaterials + doorLabor) * door.quantity;
        grandTotal += openingTotal;
        totalMaterials += doorMaterials * door.quantity;
        totalLabor += doorLabor * door.quantity;
        
        html += `
            <tr class="subtotal-row">
                <td colspan="4" style="text-align:right;">${doorLabel} Subtotal (√ó${door.quantity})</td>
                <td class="price-cell">${formatCurrency(doorMaterials * door.quantity)}</td>
                <td class="price-cell">${formatCurrency(doorLabor * door.quantity)}</td>
            </tr>
        </table>`;

        if (door.notes) {
            html += `<div class="notes-box"><strong>üìù Notes:</strong> ${door.notes}</div>`;
        }
        
        html += `</div></div>`;
        
        // Collect specs for later
        const specs = door.specs || { door: {}, frame: {}, hardware: [] };
        let hasSpecs = false;
        if ((specs.door.image || specs.door.notes) || (specs.frame.image || specs.frame.notes)) hasSpecs = true;
        if (specs.hardware && specs.hardware.some(s => s.image || s.notes)) hasSpecs = true;
        
        if (hasSpecs) {
            allSpecs.push({
                doorIdx: idx,
                doorLabel,
                quantity: door.quantity,
                doorType,
                doorBrand,
                frameType,
                frameBrand,
                doorWidth: door.door.width,
                doorHeight: door.door.height,
                specs,
                hardware: door.hardware
            });
        }
    });
    
    // TOTALS
    html += `
<div class="totals-section">
    <div class="totals-header">üí∞ ORDER TOTALS</div>
    <table class="totals-table">
        <tr>
            <td class="totals-label">Materials Subtotal</td>
            <td class="totals-amount">${formatCurrency(totalMaterials)}</td>
        </tr>
        <tr>
            <td class="totals-label">Labor Subtotal</td>
            <td class="totals-amount">${formatCurrency(totalLabor)}</td>
        </tr>
        <tr>
            <td class="totals-label">GRAND TOTAL</td>
            <td class="totals-amount">${formatCurrency(grandTotal)}</td>
        </tr>
    </table>
</div>

<div class="footer">
    <img src="data:image/webp;base64,UklGRg5IAABXRUJQVlA4WAoAAAAwAAAApgIAvgAASUNDUMgBAAAAAAHIAAAAAAQwAABtbnRyUkdCIFhZWiAH4AABAAEAAAAAAABhY3NwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAA9tYAAQAAAADTLQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlkZXNjAAAA8AAAACRyWFlaAAABFAAAABRnWFlaAAABKAAAABRiWFlaAAABPAAAABR3dHB0AAABUAAAABRyVFJDAAABZAAAAChnVFJDAAABZAAAAChiVFJDAAABZAAAAChjcHJ0AAABjAAAADxtbHVjAAAAAAAAAAEAAAAMZW5VUwAAAAgAAAAcAHMAUgBHAEJYWVogAAAAAAAAb6IAADj1AAADkFhZWiAAAAAAAABimQAAt4UAABjaWFlaIAAAAAAAACSgAAAPhAAAts9YWVogAAAAAAAA9tYAAQAAAADTLXBhcmEAAAAAAAQAAAACZmYAAPKnAAANWQAAE9AAAApbAAAAAAAAAABtbHVjAAAAAAAAAAEAAAAMZW5VUwAAACAAAAAcAEcAbwBvAGcAbABlACAASQBuAGMALgAgADIAMAAxADZBTFBIsQAAAAEPMP8REcJtbW1t83TkUDICozAaGo1RNAKlA45QPofKjuj/BADcXBlXmTi6yuRBudnOXdUJ3UEndVed3N18gSI0wyq0hyoU4CAUoQkluAplrZsxi9LkNBenVWkvVZXCGxUPn15TSt+p699/f//9qBXfqfbhBanD+7Sv79O8vk9TUUJqMcpglODq1IQiHIQCVKE9rEIzFCFg8ckAV53UNZ3QVZ25KzoMbdKoyuxHNJUAAABWUDggZkUAABDbAJ0BKqcCvwA+USKORKOiIZRZloQ4BQS1N2NoP2dZbIWG6pN/znZTbv7d/cv28/wv7U/MNXf7V/bf0v/a/2e+XHc9115T/mH6n/s/8P+QHzn/xH/B/x3uR/R//Q9wL9XP97/hP8V+03xq/sr7j/3U/6363fAT+i/4D/5f4v3eP8j/1P8j+//y3/sf+y/5n+M/0nyB/0T+6f/D2tf+N////P8HX+E/5P//9xr+bf5b/5eul+3P/U+Vb+s/8H9r/gj/pP+Q//H+z9wD/8e13/AP/h1d/V3+0/k74K/2L+2ft7/gv+77L/jHy/9e/tv7If4H/y/AZmT68dTj4v9g/wH9r/br/D/ut96/5H/j/KB7T/GH+/+YD7BfxH+S/43++ftR/i/2u4+a3XoBe+X1f/R/4L/Ifsv8H3vv+w/q/qd9gP+L+YX0Afzf+pf63+8/vT/k/nj/feEX9//0v7Q/AD/MP6n/zf7v+XH03/zP/q/yX+5/bD21/ov+Q/83+Y+A7+bf2j/m/4f21P//7j/3K///uq/tv//0KV5br5WwmT1IQgCR5W0ehZlMwdQxTCs7v5A4o5/QsymYOoYphWd38gcUWVZEhU2/rsTivKTMQ19iHMo5VylzXJBkNIv6MEARknQbky9xvrSYaDOFr7lH/sEhmV1UU3XLTUf6qsRwrvmgLC16gqL9gus7sHJEjhn5FkEK2uHwivkmEk4l5XF2o/b25PGwJg3WU8WO2qqK4I/Bv2F8RRhSI+ujedKwkRHIJvRAgMFQWfnaynB19ERyCbzR5tK7D2jQ1QFcomw5izfPbtsymK21cH+nwP3w/M9EUm7+sGDUE3p7Wf4D96S7u3/oJtKLyslR9f5jQpI/l5Mlq71uio+e0S8O+a9N+tvwojdtbcU9ofM1KkvstVBWgTLX8IIk6V8MD4q5MNugO+EF5g7JvFOiZC/vYr1QwIuav90TsqKLam+McjCY7sgkJy1FqcvpKlVdk0JLSSBoFKbqD0oRp6PVoA+ByYh+B+Jc0DPwPup8UtaX8/Lp9pkLWyJushycH6wDMDpXRotxtq+uzFQi2gERxr3pprx2FlauMJgA/EYZnpRBtIHj55Fd4InfrMcLN7MJO4O+PW4dDWspZvmV+Rm8h43HrN3eYvNvJmwa/mXTnoPLLn6fLwjahbwQ/0IF/nA1XVH1KPK96VvnW6EwDi/BkGHTYpUMq62fhRQgIwtDJMSpbXOk1CqxJR7+DWJ0cLT0sLGOf8N1Yow0D/kxiSPH9MOsc1KRhnKREYXrou+DMzYPOeYSRaEKRtaYYtuzqhLpgVOdaSSonZ4g5nDYV/K0aPDEEH+yhWRCuamYfvAEGte1WlxIdlUotaW4JxBnlgrjgM3fLr3z+O2iYdSwqofebfdsMIMcdWW2lt8CzhJrX22OT/pWNJeqdvJ+O3HQFL+tD3RjpEtv/Zx8p4oQzikyJi91CYNGgJPBtL2BLZjWlW8eGoNv20quVZC38wSOwaW1IQWjs1lr19FxIt2lZpkCsc4TEi4m7Xv2AGMAnxlULt2QOsbHbYYDh2X6SvQneFPoMz2kWgT1ZwBQyk8VIzkG9GKcQF5uKIfSjvVlNco/MWzbtYqArvI7DeMiILnbgJddi8mbAmsObovy9p/aCnlXfzB3x8yVBa6skD+F1FL9V7J81ZlLQ6LzEwJkYumtId8dNRqG5C1CnR4scZgnPmUZNOM2BX1MzPCdZ+z/dDYqS6VtTE35YmrgLuD8yYam0ZkDxDsjB906tjfWmEl4i44YkiaHR89Yxr0hCiW2j8xycCt6Nw3uBkasslCKkb4tlvg2qkh4bSSHalJLDOE0qVyYsWuCowyHt58jYmb8+Erp3+rdU7oTYSCcjK4esjGkrYthTDmbGeMwKwpvPAogluoN/7246aLGd8GAyW3pqQRcFFFc98jILzI5+CDcRgoTEztyTt/sXsPXz8UZc1T0namQSOIJO2wMnSiJAsVp8iGMFCB8RMHhCt2nyMt80T6do5iyO8IZ2Eg+92zdbj/+zAbIWcCFy2Tbugj1npLH5fS6q0GFjqhHC7u5ZcpByVrxHRZAa2r9CUo5DPnEuavuA242/mb9vBAaZTrkdLVdQe2GE050df5CJ44TJva+gjC8w0JnBi/YlDyOvCsn81qKP2+zQoA3UFa5vwCwssqFXvZAsLX3KP/XuJMgf6e6Fppo5yKfunNYHe3DQdUt8NsTnjosC2PeLwCWmNykjKkanJx05Kb0QIDBUFn52spwdfREcgm9ECAt9/LJZDKAk1dZ91qIwRxWgrSgu74Dijn9CzKZg6himFZ3fyBxRz+hZlMwdQxTCs7hDVc/CO37YAD+/vFv/+4f//3CB//7dUgSSAAIL/HglYPwwro6nXf5bTYmCgCd7hEbW8zOGcZXZyQQDEafqzAZbNdUVJFHoM/QWXvXgMq4+tan0H9QdU4pGpqj/7lQIQtyjKm73rExb5sclNHQlKkxAFrVnCFQVYbfQLEigumxJI1J5HA3m7rh0mn2KVxKYjE9KUVWN4ubU5d8IaN4uYmQZuwLO3i5tTl30bRvFzanLvo2TeLm1OaHq0VxzCa8o4lDOiuOYTXlHEoZ0VxzCa8o4lDOiuSd+B/AAZjCwE4s2X0nkAksqa5o0Bxcw+7+KWWoEQn/JmuIE7U3DDz/rO38lBeBdHK4mfH6RpAAACQcXjtI2Ed/tCo/wPsGV8JnvA13Bn2LWfMKseP9I/DF3JyDeUTMScTNjuWhc1/3OyikRAv5klHabGrMujmG8QfrWiTOXMqmcOmJFiVfFxxE/EXSXxdhToixFKeWlI+QN3cLt5YNdQJKoo8mmlbnyg13oasPUjd+5U1RtI0Q86F5w4WvzL+3MFyUaCFmalWwvWCDwPIXHagrMvzOuTYitOsnVPYo+mTEyvI2EGKz+RwnGqfMHsC75tm2W6/5LI6LrNSEfXDFx/1exmaG00VRx92hlv+P/wFCZWg3IbBElD76Fq3y0WV9h6EkaQH7ZLdXQb7jotSQiMFyZMeCQL9mQpLEpcCG9kN2fVJHOF6pgb5Csw9dJsIb0lC+kaulbKiU/MrRUQbCkLsUYFOm/y1u0LMpW33Sq8H2aetuExxTgMj9v+EbUtTWhXoKFo0rhXgea0Y/pTlksl78hJT4w2uI2tca2ccweJQaRliL3jCXjx3lolcQ/F9A6J8ZVnBtlHj1/dCctXb0bINWAAAAAAAAAAAAAAA/BycTcGAmrDRyWV5uPlQPinQLlhfj7CYRLgF8dLNSPhFy0Swl3nM/4Z8oK2JF4vYe3UiTZAGsBL+MAeDsWCc7/w/fB0fB9Muik5I9fNV9qajiAl5fmnWhss7sYueWFmiwnyPbSRoSBqRcYHRG7MDByydwIXZJI+aI8P3iM9zC7VLqu1alZ5enVqst1qKEGbfd5SeoAQLzLB8fzUBQS42dQrYEckH9fDRCdMcCZNbASmKwasvlXd9WCH41c3zChTts6n3j5W9dX8p9cPnXnEuXY4boe4QcKLKX5maGotqAS+Oj2TWanHluMmvSDL6CVn9+gbgRuli58JVaXnHCKtzyGnSjyFA1Yv77NTKV8L/f1Vc7R6O2735o28yCJUDkFTIfF91KGe62paHCyjP+7mlEe7n4wAkSuqtCqzygz+qnIAOjtQJmBS1wB+91CmdvUW38s01EqoFJpFKWSv3SFZLKbRQwAOJXhyPFJrZjv2gN33CN/+LWpdLIJonvuyHsRfIL20zIPmwTfGjc4fRO7SmVmPeXqm3xr51J0NdiP1iGP0FU5vgLVFDSLAJCJ4XDnAYdVJ24zRyS4N1M5o8vvPXPNz+H3uAhHYsz669CpbJjRbY6wK11hqq8h8srppqIQwstcLzBOg2zrjQ/k32ZacWL3+tbLDliYEX3TDx5Ll+Alj+Tsr5x/kwDLBlbr0cJac2Q+ponaA0Iv7yPq238dBEwFflw6Ri+Uii1QdaOsS0sW3XkCFEesSVHd3D4yGu5VV9/wuCSSOiCco/BobAHIc3WkDrXeTv0B9amwJjEuAzatRWKki2n50UxYQzx/bW1URcb1M66P9gxutJ4Baf7sKfsIX5prqQ3R4O9MMhlOb4D/ujy2ydUK0oZXsWCmLaX8aGUomWfTiK7AJNbwRvqWYWDxxvx66YMxPnVzIWrl3g97yw8I6M+8FIqGNpQVORo09vxwFDfBi2Ish8qLxxw3brMFqzvBCAsZngpZQgCgwvFeCcZ7X7oNzaXxeBUZ25dAAAAAAAAEPFF9yeO+nmVC4+Uwx3OkKrO1t1BkJGEtKpYAKt7bjSSMG1KBTj5wO/yB0RF6RXTEiv0TgGTPASYsYlqVmBDHXFpdj50RztezohBK+BCeYHMpKN3V9kdfNHNtRqvJHb/Gm9qxydVJ3Rp3OUJWnjLHNcdGo2UYe+CoNLmI8OO1I+Df8amZjbXpT85Ivo59zmgzpURAPtG5wNVlwVPAoPX7R9LerR6Q0KxH0j5ZNI9pDu/FciGG8Zd5sHdK0+qKdQ/4w/yCs1LMN8wOt7veilhilmDoy/gRxKi7N7f11ppZbv2Pq7PUo0fFT8ZSlkCJw8faQRl/naf9wsjxBE8jCLvYRSZ68QkozV7qImqzVXg5tbvT8RFnMg4t5Z9FUQyH4mL7mSJDnhA1GMRxLnItVkMP4kf0JLCfSvN87DGU3B+/i05HZkf0qX4PI9eF1s8GxGJ5+W/UK6umZ48pqI1G0xunLENiz0jfwGaLAyxfmQzTgeQS369hlaretV4APzMLTzNXAwiCaT8OSLWDGxT9xUFDCrDSLlE2tipzxXUE0bEBxJwXrO3HSX/js3m9Bsj7zo2pGI791rnq8vappmpFUSvoIfyCzIxxsokyi1Xu2WneV0gp94u4iR3glT87vAIG/5/+iZ9YunEniW8WOwbjeFi8e6K/EiKZTtOZSMoWcpNBQHBOt8J3t5u1EY1zNwDGpf85b3mollD0TOjLI+P6R98n5qwzhLYyOo3RuZW9qr4emKGg3VN/tFiMBKJAZTL4bC3xkjaN6oaMz8NWTohfIu24u2thK2rUGhE7xqU084a3KIa7s4mGhKdInxyfJFS8OxIxAFfDboIlXl/nvE5BtYOpISF9hvWI93k4Ik/KX69XaYwfZiuKw3yBUupLLkAyaPXXTzbXEFSr5JggxhvtHNwF4k2k+DkOXrT42//JRnXZH3HJl+IBg+gNZOzdahOJEOFYKTsBmfLgrVP6JhM1xd5EGYeSNhmhI/8J4eLWXmRTbFVXUqqTxA9tGvh+YBONxpxg7S37hELaEfJalKfqYbHi9GrwtuUCDfvKcSVtzDhShOMCmTWBcaAWleF9m78P2iCA4LQeQLZAyBwxIr57zyCrdNtcihTPpgD5v3rtWePvAfBYLaDri3/fzNrlLM7yankPEbb0JtRUJTRTyvg5JcqyGJTDvAj0HWsJwdrN1gaxTLovGOGk3dR4gf7gCBnUC95PpdANsGsnUQHBTiBXeHSOTWLkh5bJprjfyQOdKD9LXziADsJtIwYUfel/OEt+s6/Rm4yphQwiRgG+GfZpLn4Im9yshkivaQKt8cNRYyKvDUoCwtHGSdjAS+CqEt/DMoWIw7SfJJkAbBircESW2D3dzBB2LXqBGB+/4Mx4iCyotkHd0pHw0+pbUPdbAfIZxVVd/Dn+K5tJhxFMEubcfZj2JBMHizxtx0MAGyZRNMPDktN+qugvWbXnra1UG/28K6wAeIdorI+D+u8oHdgrhOOtPVl4MCAl/5iqt165gUoh+APkYecjN+Nk8+Q7TmfvXNnIMA8hz8GvI6W0rRLgHyTNXHrxNbF11O3Hra6GQZvxirwFwKy0kq6oZykbhgmh86+bAgeeX8gBSxzzI3tSStlsSWdLLo2o2UDfx7Kf7vCG3YHg4Qm0l+xDBZvvWgvYEnYkQ8wxVZKFhp1+TmtHl+RKmeh6d9BxDyZ1HEX1yTr+yTNWpz7BYYnU1748A9BnFsii+FS2I5hV/ITUdJK/ojQby8fOc/TCGcqIXrHecnSqqrU5nfUFmkRlSdDNshbWIyLq/B6EMIk4gnHxgAMEevSeihav7KQMPfYITzOZ8kJpkUYSxdhaOcLM0H6gGmgIysAyYOhU9A65lRgZd/tdR9R3OQyIf9dEdR6fMLPfDre+h2+DsjZkyg0D0BBxYKVjynmKk74EpDfevpilYPoLNt4kBgmOFjCom+3kX3eSOcMJMlUvtTrkyHEer2XANZdyx2YBTkH6Kf/1TFWwNzRhPSe/ZOIJ9aCDHfU2sWFYft/5NC47O7F7SWkIBlG5aLaFbhuncGxuwpdJOQd6yz/ZLys6VNxj255gtEF8ikfMiqKkrrpeHnbcYLHu722x4KLbtPYmd0KqNYWs9vrVTWd3yyJl3kHKiAt2ZqfFc9f2AN6Qes5xlSU4d6VcH1V+HpatbUc8j5tJzwc+Jrm48odQCkpYaNWbi4jR2nIMIfANlIlT7LJeLy8WBZ1YKPvQbkUoIotfZqKVeX2Zgz4taJde/p2gYTRE+sGjYqiHkkNCM5Pyh8/i2eKP8UQdZe9ZRb19FD81wM5ixLPNs6qcO5LD0LIKBjBMSoGOo1kTNATkKZtKpR2WwsLeS5P9b1zUIuEJVdycPTKXbrjjN1VZfccAyyjLSOmm3AZBsBgcyCeuzVusA8esM0aayIvC53/OdZPGavML6vwHCv/erhah/dCZTh5SE8RixTgTPB9BsKQwAWEy7FaXGtc07P31fyIeK6sesce27QcQNazm5WKUt7ETWtAM+FBQEk7xgzRd/nXBqK2oYovbYNTQ9PCq4Sx0RLBwz8uedINx8+x7tcC6P5jKczvw4HBjnJEG+Bfrkx0KkaOhOnmCo4lWkcPbvNhfnXCaTtlLn3WXn/U5Vr1uUbIgQH/ZzSYekVM4OzmTv0ibjHwc76HUZ1cw/3KEaQAaY0k/NbznzyBhSKEnkCvk4a4fqxJ/tpqYSiMaIJKYvU++8zGu35w6mrx2qud6352gvTRZtLJC8tdHWAL2SFluPMxyV2284PTaJgvpKgk38fxA2KwWt/iYQALq36BmpxMbyUS6ebq6IPwsRSXU0rdEQwI6J6kPvfM7lDoDL2t/yewrhIjFPUwdrv1U+J7EBB4WLjhTc5WMzUK17ClqY5dtf6bt9Zp2ofqjTu+V6cISJDb4g3AnTldOcnlXKu3ycJ8FBbf3QGD+/OHblCBdjQeSulCz7noL5EyX2Yo6Ci6wy6ryiJ84c6e40Jv5CZ1P8HUgU34xJYFwq2Iyu0tYYUp5aRwGIms8lvYDOEeVHme4HKFA+HptASdP5gDwEzrD94Bf+KfXszB8gOHQqFFAx+fS/2PAiU68ywEv/CV+FmQyms5CmqIQoDCcLTdkvsKAyxZBuklJoaGtcr9IpIPtRvnEtkyBiFU+cJBrK+2HR5fl9TCbUB1qeVtle7PA2oKfMf1IUaqjcUK7e7l6XyHMOElnotlzsiJta/B5hbtQY5VKaKUMRxhW0qNYm0gI2g/uk9YPd+sCx0EM1l+zTJddukgyQ4yF7vJ8pFkRTsyxvRWa+xQjDnKxF7LgushFHL3pikosJb2RLTt/KOmyfDMJS36DRH4GaStyORciaphCW2O92mlGIOSi2X/xzM4TmlmIdw+60p62LrxZY9F61kbExSC8b6qWZi8t7hhDZH0N9mgD/5lDS6P/FPdMiF9/cfoAYgvVz6pZH3lNvrM8+zc+Q40pQebbpB9HiV7gx8ScVO/rjGR9KDk/7aQlnTbqkavP4BmVnzyOCw3yejK5S7Ou7YxBcpAnJPuLflZQ+O68ai+JrMOqJL8xS1/DSjcZ7jbzSeg4uXpeK7PYsuj18w6AiYn8Y9aiM6IxrSdgy2nXY13JkkmJsW/bweV5V58qg9uadjUZQaLnTTJP50KyY4iuQ+qevvRKGIr4EqzwegCt22LndB6uwC2agkJqY+etumCjF7Vuo8uTLySzELhv+847DS3+7RvvQQPHg9F2uvbzSOokY5zCkriwtqaqM6PwOo3jcm8ut76J1048xqtNoE6rkyn3bW6MvBQk8DYsDAshbczDmY+g+b6+B1FOCl8ytkKaeFsogpxkUhKyHlbuKmsx/QjU4wD1Mz4EdCVyoPUQA8+Z0ZSxkMP6mEnumt2nkvzuv+XcMbvV9gAxtIhtzvoqwtnTtodf5HvLI38jV3g9TcWghT4XfndYudya2emiDFIAlxr3EpmQ+Ez0KiR0H4/Ce9sYjvUAGi3sbkY5Y3LnjZTnnJx3zbc2U3BHwtT1Pnp243Dn3Gmv5k4f8jv0+L7AeBItygF/LZxUPQEZRzQmiALq0v67Gtp2dlSvCis8NxRXpmFPONFqsz2pAec85dbNrv/eV+rek8KGLAMKD2CGIYPhAZzUEXMG6ktoABAXtuy5tHp6xX/rwQuMn6Mtglim7VeOTdRRFYoM+wf9vh40kW66dRBmgZL/B6WAa5aPhZAQiDQPU62kBWXZn3OqVpz38Lfj1BThP5eASy2Ai05IaAy2u1Mxbhy/DmaL6v9sXQs3sOb4bbyGH9MnwF7t/Y2Nom/z5RKjAu42AGGJCx2DR1bWQHU11KN0WEZzTrXg104QgjdMM/XoaeHovlRcnAfCSuZYQlRZW8MO4b0WrHQ2Nz2ITE2PcGI9+wZBz2gbf0skTCaZQkyle2x4vBX0KMhWWPwh4X954neZ06QBa7sgZxMgUfVAPb7PP8flG0s3hKEloHLNlGjT7ZxZCCSTCDLW1SOfJ+mxZkZBsDSX0Fp1arZXW5+G19XTWjmNnSuxyOb22Zo2Ajfpuds1fU+0nZXhsyoNuiPS7MkvrQkP6ivAmlekJAGPh1r7N2O08JZp53nX1T6eaYIXQrUEw8G9KLtWFCSuv8c3h9MfB1y55gKsoVwZg1c0Z0xudDGpEK32WvNdG6Aizjq8rsrUbOIru4kBid18kBLErLJ/fz1/nZkAnX7UuYyJ/q3ZAjmYMYd/ONN1XzAOecPl98FDuRcuSjlEkH1dZRtGFFQPiS/7AreZuPgeI34LJuUXcXLu9epS/eLcvwawiEasJVZcZ58L5vuNbF+XPa9HoAinMU38O2OF++Ut/R0UM0MaomeFS+0vWNFuRsPDu+PD+mbvS75CjCSnmx6ct7PMU+gYJLi1ARQn3/hq4a5/plfipgC75RQl9c/Y4mZRsg/yc7x4tQEHwp4gEYxPfNgm6xYsORw6HsRwOVL0kWVtZCfKo565E3tr3iobfe4qwpOtHe5IpsHT6afKCVP/YntqS/r3ff+YTK6fQldQ6+6XQuGyWZ0bxDyT2Y9o5gSahMeG426ypAYTDx3fcFqiuJZdIOmC33+PH1HpcFOKxIeSxoqI159z8RYLUOQH6lljf/Mw+S9top7CSWTZDTYM58+pxQpyP4FBiI/nF/b5lDyHqeqHyIuq60T3JgQkCSIlUzuQvpRxgOqeI2EvR44vHG4xLXgyfWj0Au52rt5ACXbfI4C6ORlk0SNpei8tWzR0UIDd5UXooRabJNGWbnOJPSA9+VE5MIsj/TNdOurLOQoMT0a0IJ29Zw6SGAHZB8YmBCy0aLCO0LrpJPxfpuowL24v1e32YtaAciPDVRBuhYuJ66uzYwuIwBcpc9d3bxPXw8UcEk78RGm0UZ/yUZapAK2fsnkbW/lXIMlRSbXhPQ1WvUsk28GdeS0bbM3PQdQr3tI/iIZ4bLHUx6vjgoNxh+89OTZXQ6SMR13/iGM5hMd7fMeC9nvIxYdGiYJB+EbOr3KoJCwwBMbFp8UXt3hJ1owyX8kfwPi7J8SgpV60FCP0h5qcCHFdAn0BMNwlZijiuLtGCnY9SgopFcWIYNORQXGvywtWcBpAbSOLr2yCDfHknX8+pbsKcKPqZe3xA8MNCuN0/UxoIhwkBdVfpQ3xlXo/1GIKBUzN8EGt8smlcyiXEPeap71zv5fR2uDdnOk/J7uCGvb7Gi/K1jjR2qQu5rQG2LMFvcUUf9d9rlfDhv3pe9Zt358JRiL/UUM5xe4MFaq1s68uAK1yAnwOqMKOVNyFjAs7U6geeMTnsfuDOaKG+LTvG3IJV3KR1vfrYyqjFO+DULTMg5VzbUBXkFJsdz3P8xd+79bv/eUZAQspX5OWj/xGfC/LXsJfhanIt17yZVZth9SYLDI4tCVLxCq/+mJdJ3WBWZZm2ALH7CLhu8MYmxOVon5t1tga/UVJqStkcdjywxtMp/iNXSc88+kMpLR6mGJd3GSP7F1ETAmbusasIQiZjlC+VzuPmfiVReEfnoUT6jEbJD0WNoTNJM+CenX3US00hpAXGIt2c1ghLy3enxuWL60kWjCN7d4PLHsYVgLevhwARPVbaJ9L+OvmKbKY97ZEU6Vw2tOzYPOv3/7fgZQZVQFvomhYmcQ3gx8ggDB0PZA6z5MjKD2bXOA+BmfOK2FAbW/kh17a1Cim+UrOJoDJnLC77bc30SzWyA+CZ83lk73U55s1djTKXPFoPxEm0jKRGxugj/cYt7dDSEzDq9+6Z3eenIwJxlCwh3D6x4Y2z4GuzR3NuWLVpg7L5+mljEz3C7bqV9p9+mxxW+qlOcQ6HTwSTJMt3Vz7eHJEyLBLBUOcE7GOu7lWhMLeqUgsI/4cs3B+OSbB8Ql1yfR3UdPqz1kEjaZjJPYqOAYgLm3NWywaV2FxmOXO3p1D665YeZXwJ+DLEpVOb099bYRh5L6HeQt4CFHPnquYE/lEkIMPB5rILOuN8WiLXDBG3CjVmBiVY/YT9KYyKpcn+PQYjlceATYYRveZLfW9EAdlgl1UrEPaF+22kVo7JP6GYtktxvN/yGdLbNCF8BsbNzvt7Qv4wjujd987suAYHlPfQGLxz80UC9j6hqW37JEitfLerIfEr3az7QK/Ds9uLpjcnbSsDHqsJw/wMIGgubjfIBZVGMYlIaIqMHDCQ/LAPuonYHQUMgURVa06xrleNd+rkC8LZt2yFNKw8wToy5O/w40UwN6E4lRkN0iFRRNtDfJoWbOFigfxFMYctHjVBeRhhaZ/l9bpSiDD2bfLKcGtnzizzZhYDW5NMGBB76mSWwIViwxJMm0HamHn/aRuGsDonDv1GnLqWaQQo6dh80qIoyJSaLBu1wp3sVlawytxJYHjEknOfFTsa/zXFJ2WtqLaIh/My5kmqkdeRugu/op7TJv/nKv4Q7NcSVcT+WOWCYPS15L9CpH8MAbmrw5ImLlNWqGByvN0iTz52BRsqlDbiS8PSmQC/b2etFLUon7i/ONo4PhZLhJBLzGj4X9SYct4bKEj9zzlNflG1ZbutoxN4QmYoNNPqVzXWWc1sg9i8VGP/6PKJmrUw7Jr1QRv8eALBcfDdLOs0SVAedBbd+ZaBL8J1bqw3Yv/7O/tsSIJotBGQtrFXrSTDTOOouVHPH8Q/2IrVSd8vYq8qRjskuB+1ThpGfHuH7Cl6Wcq6VxA6vgzv6YyLkMmhVscxcL3YmzZrsixUs2Aa4aw1Xf3T0ffQSOluQ3LN1uEf7B1oPuj6RKA/8LgGD2hcDOAx2qLoGaHUbYf7kDINYX6COVwhRHzI+IkHroGP1UsGSwjVrXN81sAnaYJSUlSJ3fgxp/Aeruf789mJYWQ5HYTqE1vwAB6jx1GTB2oKMetGLjrmBH0THjAe6uR6PASmd6I9haq2felDpU7ddwN6K6dPARl26eYjHgsCdjjKhuPwjWUqRGzDb0xtSARCfrYo4SBD5JvJoabSY6J5fsXI9BNqg18sgc4YzZOTZ36KvXhWSXc5sKyzZqeHmMi0jtixZFuwHy0s4ChprbiW8VA7NNaeqohj4kaiHjIkI2jcpUVQx1f3gQ6MhiHu/pAXKR0gK37pY0CB1ugGLIXXcjjQAWEU0gFYLcIxhLYX/c52/21CRcZ2+LYKQOmq1UXuXtorVQ0yycxM1GNDVCRcjro8QuePEN4FVo8ZkRuzWM6VDaPMTTuDoVbMJqRQeHGm3XzChyOVtRrM6jWOtTZ1sr5pkWESxnTcVWLUgbmaPIE5Qf+5n45cqfNUk5zwuU+E2ca4VnWjbhVAhM+oviWGw6yZleNVhKVWO8oVd7jRzXN1aIH5wr024XC45NhK0smTbUYV3bzsHvRUuQDgFd+Xp2bctX7aue3DxDXAa3OpFtW82D815dEu9EbzFDo99fKYm6AcVyEBGJIeHrBh0XmEwxx0q1KEYM8Sl49Pb0nQxWjB1MkkEWKhhbfFjQ/MBAuUe+unzlqHdywbmBCJToP+TkPzw1cvEzoARnwULAcuJ5TGBYjFKYrYdTuTegLPsetrbPk/OpK3rBf0aUPsqdcpG4EBjbzION6k1EbbPvyI0eHqTdv/mGQjii0imKGecjKtv+IOYeT6YcdRgfvwDNmEMcViVHEjLBQXFM5a+H/eL/BHxIUFT7NCXJEXV4PHEJjFFPU5DCuXBURcp69uk55PHtin6lZGmvIr4Eeahpt+NtXfVhp7aWOyEVNebHEhsttVe5vofdALrrYkUmcIBbv8u+1fxekfr0gn6eCmKvCRJsjpKLUdXuF4SpgREKe/hdvrSdlGpByn0KKua4IzagioZPr9AJk5rl0LoBGd7UAskLE6o93umsLR7hR4uBauyY1LkNRaSwoz/OSJ+ZhhLZQ9Yi90I8Arfz1Q2hA6PVzpqnZjj7A/7nkzw6hG7C3jx6B/C6A6Le++kSZqOqFAB6MqHwRau/18FeGBeW8kh21n5+4hnk0UZaYeErKKVcINMVFQ+8DnPIz9an3hojxFD8NqmXWB+S8hOh2DZCWRhBvnsdHlOOYCgsnmtUurBFCsCvm03Lmghh/o17iL8xDcFZNEmKAXw7yet7ApfXkkHHoe7nX9582WpYPHEkLUpWkWVkEcOdVORt49H469hNNVL5C8m19NFLqm+4W0VsIlP9OLuPGfv4LieCUdYFFugUF62XPN/bHUq5sBiM2wR2fCcoWxKVhZ8jNulLdV6aFF/OD9cdV1+/ug420JbdlJTMGVNVlBCjgiT1iHvHb3nGrIaVg9pqaxY37k3ePzlQ9G3ZND+XnnRWg1NQ2L7/kHcH+rk+9a8Pd5LXdBFZM/tcBeSpPk8qy4ypNzMFmHGJM15vGYaxdE02wQ6RKG66FKv50JBO2884+cDQNKdrZD8tjtz6YrfZcvwy+foaIKOHCyS5D9xbCMjhJjQJ79/gFLSCvKMgUpj4OrHDm3hh7EYm1cWhYKrHjw5j7dT5GV2zBHGeJ3xBeVwuuFWOG4tZUhbejt0GhyKzKKLg5DQN/AvUX8m6qWMsNkF1x1fX8ThawaIZ+qRiUeXuRUc/P6oEb9KkAE9O28kAAL/oBaqDulvjP0L49+hH4+eMJuNuzfKiNs/VpHqdXsH66d8w77XXU2C7G4FkslUrVhVIptfnWAoS+xCNHOb7m+BLyFN/LbteFj/VZMFMyjTmDP8DenkJHkCYzN6xEaIVlWvzvqFP70ZC9vQJhHFCNob4k1/WBzNu0P+kFGPF3ta0tbrXeETPxV7j2C6xHxmjOhSxr4HhjahtxUdnBshMlwMKBDjLcPJ/RUJBahyYz880Z1f4fWvQ/R0LCC3pETyNbwtkf0kRqRTp9MTFjormEBfYuH2Sv8KsfyQFfx7IcQpPKPJAuAFAZciOs7/seFC5arFyWHVyMlfP1VjPIOrU9hzEROotA/R/BePMIApz6H3t82GjZQNdnImcH8v9KUFCvFXSzRdf2zy5IAdKTPip0e3KRcxlyg+uRK1BoVjmHo5OUakyJYV1Ri8knO1y+KhTNVrqeojmFG4dzFdgy2KJOAXr3myX6Es6Ul/65FxBD95u9Ok6UwHkaOJa3c+JFua4x+pN0MssLDjQMbA+0nhvGRguv2L8EoWCafAzIzXocmoE66dbOtvpDT6IIzBy0kABM8GMI1mNod8a5DCBYPQt7jDPRGSm26JaxQLnkIyZolN6rzhkDMZRaNeKcYf9OVIQtVpZGvH4otTQloPBeuKnPOoHSsj4lRGZ+iMfkPs6qCQL213ZXJapVD+3sHtDFj/bnw7sGsRhSlFQxntxafCv3FfeSDrGAKYPzu/+ntkn/o42o4IgkPX/nOVK/hjyeyhhm5Zk/1Ya/hGwHlwzJxjUppxp1WTxYD2ACmTPBYllkss7xcRStTPRkO4nf7nOVv+ZXiGEV9TVahfSS+dVrUY5RB6rK3axamc9/fAE4YmBT1QuSNQkVBzWGAoGjzRb7po+GCVu6oy9cGQtWbUg7GxlZJzoHrphSdJAe++Dp77uE2gCY0+toK4HH1Sc05HUGXZxOrkMktB+bljosM+GlX5J6G4xV40UNFHp0EyNgTenA/cc8M4210D1ZSCY4iHVtsO15aUzQCc84lAEitUaygQB7qk6l1JDeCN6vc51Mmu6wn38yY3+14HCvXy76SqwS7u8NK8jwRevY/VXdgEBj/fTNLtTF86J/t+E/uN1z2S8TFUcKkGYyshfX4fy+N9aTN1Y8B1YP+9Ivq1R3yzVylnwdlFYWIvB22v6t1qJ59/oFhfOgOX7Lrgfl9y8tqOdjH9JDqTvjyGM/7BR1WvNChAMIqfLMV/+SoW62sSV6wfk6DHOh/lsl3SU5ySKJ8wiOba9fvIfKc8DyxCUDoF6znAxEarN4zoR8coyzeFoiepSe6gUixMNC7t+PVNo7zgrmXy//ty+3ddKn0j0q4kURnjLXN3xTnyPWCCGc3tvPR42gq3lQjEyCcGYhd/8n6WVc6f+U1LNKeGh5yh5LH2gc4wrWBrpvJP6MiOE3Q5QK5aMVKDQDRP65ZEKM6GX/+xuwmeBRVmjwaORf7pK5k7X8AkkQsyE9Y1yIHpBhhgwnyCiaa6l5jEzo7DvH7ijcoYQdUj69nl6qAQq67aa3UDi9SmcWJJLongr0f/SNrvylFB0hgQejN6e+hSTwvobektEyuz51gu/DSlTMfF3rIp6uuazqajHj/cBZ50wXYAO8rJg/Q3Vq9qnWDbzdlc9XB7DGhJWbNCXuJDfL1fgmFBb4ZfneT+bn4+7T1TNMU+QeL9yXq0PXU0aE0rxZ6N8PqcNpf555dJRWFZg5ZYKSaTQq6o0EH7En5D9c6OqQy0UPgRS6NVtGdzvNtTEzIVgAmRQmo/vEWano38MwEbzOHHz8lmvYOcD28nbSbWfuLRWbnVf/vpHyv8le4Yl1nLUET1twZM4DKq2AXrYDGn3FsnYbvgj2AEcbqdyKNRpb4fTPPafzsd4tCmz/szT0t+r1APo8Jh9k6Fz9Kx8ZiBzvsf18Gq9/Xf3FCzF3Ms8MxE7xCt+OBMmHYujynGHgtJjknSXxfUdcsHaWrpH39QjjkcKe26qfyKjiMvuwSoALEsdd8opULLem5GcSCODFRO6o6/DQJi9fA2HKzGHCcfNr+/VINfakXa2XORPPcfU8iv9rMpza/N+DtUAh1JM3nNNTfHyKfbZl8FvkAmUUS1I6r1dsfkZOCRawTP2XapCt0QL8/fH/Px8X+wquLcOcrq/HCDwVoKRy++rNRA91jQ1NtggFGmmx8tmfn0dOzxm2+f5N3CNB3TwNb4RPu04fSrc1yjETgP2CTV/fZbtBIE0ARJQnkUjdXXAj1Jhw4ylxH6DdbO1a+Q9oaPXIdjNYXz16REZkUVmh/0uUsUNH8DyDBfpQeBWZ1Mu051//pazhGaKQXZGcCzq2JuJBbHKRiyO+KkY22mEKIICfD8Wdckgn/fz5QeGaY8vTkdDWLaCpni6SKmcelItuowWQfYuFlUCwtTmj6LiT1POm08VH/VwChKvsvjFCc/zxOOJGEIlDWa7GM1QaWX4ZQ3LPAh7hxhEoz1+8cGC6IvzRd4SPAgklUBV6TOBdn5omHhWsNt9Ggx+USDYy39rR7KKOrXj5NlcmGCEV/bdvPngepuWeDIxQtQvHseHwPeq+EhSk3xgDCmf49UVplpM0k2L2HGlBqlndm7c/rxXTTSNIxRsajAIsp0SAb2D7/QZQK77D0ip8lbu0S5+NuKTmae5NzhGng7ewbrvV3MpWVEbDU/asWpiXlKaMtVByjsW4G6nbTdB67EMvx+3JCXPSGFoEirJUmBCCvY+nkku1umr4f5HVqoGm2JXArS56B33wGSMFw9+UvgW5m7knTz2xMUymTr95pgg56BneVfuMgVG/mu5ALVJb1ME/Hv6nE/VbX4zE3mV28tpD/wHjJjNj0akrQyw7d4fi1KLAsuAgxXF6wkS8bS1r04FivVUTC8BS6tSosbuoQDXGBZ0mTTHR/vBZlr8zko62Js833+71hSSIAAJylwcs7efZbXXFcrnz1V0QnT+gGrGhR8TYcatI0fGBTKRl2KTVMZno7QRRsoIXEgd9sjLcV4Q2GTCK6D5QFwUyM5zPYxPX0TReiI3ZM+IHWL4mLUL9SvArwBRxi3v6x+3SZfyH0SpoPbAhf1J0CYqB4P+tXozzxZq01rZXmFyKd2f0owARVWYgqmg8t5dZBR//wISLGnK+/HS+m9Y5ya2+WK0K4xt/CwmGyu94LIkp3MQWK7PIEpi/FtM8zT9moAvBVRjZstTgrhU9c19Bv+c60TfrAAzMb3Kcbd/ptDcL81q5RIS+C2QT98T8l8nfW+k4eLtigWFqy2hfKskPTlUPWDrru2GfUTV1ANMf4mWQW67W7RrElN57tiYpAckMC48qUaruNZYb6WyUfUYshh/0LEwQheLiOa6jwyPA6fhC86oCwXBRuezG94SV9aHa9wY8viEE0y/twIQJCFz65mTAtSMbQD0G6vpx8OMO60GGRfbbJ4uuxCUgSvlBWPSVVTP6mmLpPevBV5kkgV4f9zDQsa86C88X8ZMB3aDyWQk01gRtHjb5ArfX+y9U1eiuw4gFdVidWNlXAOUEdAgxmxsTYgOtUf68Uedf1ErFP74pj+7huD8+ht2FREeQaIhNdDhYBXpyBJGmLCW/bMk41b7epuapKd1Xrgt/0kSH9uOoYRtL7IZyYkFTs6AATEaM/mdrP+TNIpdvvHPo/OqjE1BgtYbJv+fjPEMXAYz1aNwU7El1v07yOjUdM3eynBt2fLdOZ3/K/ZgNcLOv7eRgyrnR4QGkIKFQYvRdJ8ET1w+vCx9RTjexds1BpTzhPAbOKiV6DsZhqKJ34ss0/qoIRhRb1xEoZnTX1I/QKaF20mFK19lvqDksIcExU/z9FUWc2XK40dsb5M32vC1UUnXUSTRuv68OzFpVR+wrYiw2VkBrQQ1HIXggcuHFUxAMPmI9vCx9dQzm25uf8LJZ+N32O6Md8ce5NQmV6Iba79Svl31iu93tmbWp5NwTBSEL67syc4Sn7hoOGEaWcWHTwe3M6W8NwT5twmSNYDsrInD22rf5aeTf7Wugedm2XewFHnf93Ji5gRyQmQJrYJLcv+M1HlJnBFf0kPPhxd7sFLLv25S5qy5y1eubH8lexS7dC9OFqJInlkc3Z0iOIF2frO/tu5l1sc6Fk/YWWWzDv/vy98AkSLEvXd5B3ghucRACdq15dbB56NShlktEHDNsXznCzCE8WQOgRs9g3FvkJ28mRqWfqXjPMQGBJMP1slumWERt5ySSPoVv9TOtw77lsN/P10vKzmLq1mBFy50a28yIEF52QgoI/MgANSwa1McSM/nEg5aJHhsc8plRbZKhGuaTJfZTtTO4E4QRVK3AU4h3gNaCnLVVhO1NEjwll+plf7l+uGf03fUQ8SyoKjmJzwBWu1U4lX5dDPT3HZ92nPqziGOU+NCZIL/RzmLqHhNlvSP6TCgWvn3GvoMPWcmv8xCu7V/dyYZXCcGlTbiCQjOZjKHgP8imJtawkp4pP5e3GHH81Fg4sst2Z8LDWyZ613ZuIWb9xCN5Y29vJURdhbEOr6U+ppwOvy5U/tmYnQ85wJBKR2pd1w7gU/eZDyJ7u0imt7Dvc99cSH0mgAhZhkthJLea0lE5734KiUu6ZrM6GwE4ChI12N6+AIp6qTlFfarjR98gyoz1uGcRadTXpUk+yefW3JrxEXnfIM4IBRIiluEtLM6c8i+UVnr4qvqVa5izNEfwnhVvG4Bl2kCJAgVDNG2gfaJSP9TkX5MvnRmF7reAy+n3G3C3QleQIcokY5JTcpdRlDFiskyMnqoqPiokm1A5AeFguf8u/8WTk/BwIDk/oYg1PT6w4TZMdcNdJkCpIXzMYGWETSCpw5yRsF3Pb26GtW14WGWu8TrAxlaJkRKwwVWZtxfhIQBysyUWu23+2kI7q6OvuqlU9dpmfE/UuRQs2Uxuj4QaOLvxqZb4xvTJ5j5dvmHol/pazXD5MErktgwGLmrB+ehztU+8GencA0Bf0iqHjoKMr/O8vf/eBHSQhI1K7Uc3UnwAI/xcOCnP7edKMPZcyt8TCqxHR4h21WIH1ifgqZZctRc7XiaCPFN9DIKKVbX6yV4wje+Wg5icAxlZer4BtbX3x7DqoSXG2VjaprCNrze+mgRVo3pOwQAUhT/obbMY+UQ76Pl8/UZspk/ELi+ShY4Of66R9pVWcAPawfcKJLhyofWoqix7aH5LvnnfSTDS6V7ZxYWZWfwLcV1NfpACfOfG7/H3gG0VKlhlk5G/DtvLhTJxGadFUg/JbeWUSEQpL7FBw4utYW5OzSY7tntEVWdO5t6PYQ09wHW8zLxgnoHRub7CuFi4gtAW3mHD9yHhjHm5knlzJqmkIkopj7vkDEOlnaO9vdmX2T1bP7jGGA+oUgjxMNzyEoTIfnWYhseWCDNx4jROZeUNk/BhO6m4byW5PwDR7eQxdpakFyYMMG8DMObE3grG7ytx13JzEzwDfmP2BarJq+9ksEJBBYfzjMGCKtQ4jlF0FMw0Jq31fp6Ybx6eoE1+OvLBct/zWUdKlgM/E2LdeXfAbiHQxaemkHNIW9ElK57rojYKtOkjnHRS+DV11e0VOaI0PzzxXa9bPqfoESj74jrAAQnDq6p8eRlvoKOHZx3HD3U3tdss26CD1xKvyrKS6YSdceVIecW3u5xe+O4IAJmHwh0v3F+9q6qkhHJ3d8Um0MfZVF1TTd2f3uKvySXQzzNFj8kSu/y+3bBpLPf2yKyjniZvIhcfZVZKwrsQhdduhU/5J4Jf4+GK1hkUrQ+r9LAFA6eji4K/GrXfCtEPiiTgJ54sn3dWJi51nHjgRoWaJavAgvkQsHyt2PPubl+0RqlFffsgxioQhqt7b/iVSJS7MRoA3Tr79J1aHKep0ZLKQ65ElfWVnhXsUVH7BHw+ZCzy1qFUiG1uJs/ZBpUh7C9AmbkOhUVBSoIJ1XPpkkA9Z93zeHqVw/aSxC2vYsBp9GxzRhfXUrHoLNGF9y1c4bY0vaL/S9LbCQA2JSm8zM8Dm2s7S/e512sqHeFwQDzjD2mMdfxTQiQQwNebyH4/PTlCTswrUnuF+eGSlhwMspmmaepIioXG1KfXavFOvWbsdDGEhB22w9qGKFgD7TC8/EqjSMaLjGXUWiccuazI9xybYi5WV3NJp+3AJSAkHB+Hh9tfD7duztCE8eCMAX9lHgrcxie4YkizZCoqVRwH11ovv0TGkdUs9/j5hZj8VKX+STLnOPS1vRrU5nMT2FxCCZQrDFKiZeczK1rFp8znnoyfmCWoRPOE+sanGtvP7KlVQgiV9xBueOwmcgmnlIgppr6eQ+PK1ullT2fcHuuY3Sr1A3AnK0aY9ZuEIqc+rI+6Z6DQOQl/bxrJKO3lpS4W8Me6uZAa8mi/3MbSkHQ/+8tbEim9IosVMtRG5PlWL3swYM8U5QJq4geS3ya3EZbhCKTM7xQ+WwctUMyT30lBChlx6wYWMKwvfO3POGJQ6LTqJWKTqEO7/1hgym93BbZKGCa+BlkJZYpqvMSaGXgu4pImH5F6OALhmgV9Mm5W+NHOsKCiPVrSNksdvim6wEmY9efcjtaYbQf7oiMqO7Sm63JYiyj0Dhpb9nxRqZebIsCsBaA+/xbMNfKKtVrVfTVXHfquhFWvK7Rq2rKWwu3XtWAfLD8Fyp7X9kx2GKjxuPEelU9b0bZyag7AxDlXoLNO+f9MMDMEm1KjbZapFGMy06YtdtD5m2y6KpuzqVVXUjkKeAIaSqzfpWOrty7iiMuFHjf2SS2vMBQKWmhKFtiRDKkP91D2c8jEZ7kX4fm6XSVCtpzEDGVnbAft+QU+0NvvlnzHQO7025DegthMHi+xQg06p2FEPRodJj+gDqpJQUPhcNU4XkVNoh3g3OxzG1AOQbtZB2p+LfPkEFLUttnA2Nw10VNvMkuB1ZuVTP40WGoh2G83BkUk8FPgC+uylz//3pLuaXFPKWnTkNue4qxP6RH5uZ3V8lZhhIwzuRvvP/csSkMh/zA9xHozXv6wacJ/M/W786y9Er1yUXUFU/XY83EckrF9xyH45ykCOOv3miAEY8Hvrfor5KQCMXYsdDG5XPGiWhaY8Rxn6TYeE2qFjUOwrJzYBCjkycYp0lq+RDCZ0GJ0elvNBqmfWtnGTuAq6Es75/ELxyJ2gnzjT2egGdMQErHL0dfJo8bQtx29og45YX1vPrI4dP4Bh7tVm9sWgXyxYj5kKemKvPhHxzhOODBmyWJYSGqNJF1gMj0A2DRQagbF4JWbxoasHYaVHF8UZQFVNwVbLKg603NZR9B+sbmmtB9GoYZUDHdj5C6SOZoFwgvBnESy+/+o9JPfjbCHQgDClAC3z80oaww1c25YTDDPV3tKoa7lPRicUrEjgsPg3ye5iVhztpwTn+gB/dhk20HkytZ27JI38bAvYMvsqBo4etwuEQNacp2UuyleHdLdZHn9fO2IwzDJ42/lnFZRf5CnrqHuGJmbwsI6/+KgoMV7yumcBulzD2PEW1e+gAw2aggefy3Oi4XKm0ft1TzhXe/2ZvYFMblDrHFNLRdE9oi9Uw3H9eymdOd5jTNvfkVwn//7jR3p8n1DgJST2LTIrfQl9xWQEmiDMkPGHjUJiTlyVCfPFHzqoh/y49ZDNzwpK6mRFbWCekELh7J21d/FwSHP2Pm7dy5ktleVAG8v1Aczbq1JPOySpz+YasBDScOaIuTR+4/4dXVKnt8q//6O1z41HCeKboqOiKXkg4reytBojSZ+NCzv68FkBLnwLQv/S4mVgMSIkWZX49jg09qI7TdKvfnMsio4llLC937/7UBxX+TxfONe18myirUsZn5wbkhSi9a7DK9xKQHK0grkbKHqra13gLGloRsIcXl6zRr7kVgkwXIUnmMkQI2H44fHDl4EqntecEH/LGX6ZvaZnn6a2e40tfPxXzjQYQPv+3qQRjEtR6ILbzZX5U58oiJEUXzNI4TaxD4ijEvLwkn29x6Ge7yDZDmhspiWaVNMAWr5pLQpo4FwStgcxfATT3Rhi4Dp36dINacsC6Ey2RHsqcM8ahGWNhu0wRw8jmQzyxtnQTQ+qCGmNyUpipSms5hFgdHjkoW1l4dyPIvlI8HzbUcrh19QN5MhvIW9AVLAnFohtcgfgXqKAq4X05cTEOaR/EpSC4zYWbqcBtVYFoEbkppmNptro8KO3LmPpHMb7Z6z0dAq0bwVK/rDA5QQQDyQSbFtN4NZ3dEV3DpFEvXPhC2M7u7nQF0RzZr7u8zpG/Ib7l2seXEoskfNn6S6lEohN/Xcuq4QH1d7+5jNB6rv2geOjL9PY+XKduJ9dsHf1eji2SjarXITuLOXDVLQXdEeoNeAsrGNCfokFwBmxVk7ZlUgynJVxPv7ZcodTaWSFG0g39ybhl+5TngabGLWu+6wXhzE4FvfHWULdAJA8jX6adyC19MJkyFrlL1KoTQXtPXz3N5KcYeY5dTDbg9ys3SfvaAlmW/f77+IqvrMbGajiNym5OXyjY0pRBigRnVyiyEmQjNhHhoarrxfdtyHZ6E2QaGryrQ92/6Ll/yfwTKgz33yXeZNVCrwM8S/M32hKayToAQAGtqijKQmODsx5HMBtJCEJgq8PAjJzgRcX1hlDOpxV8rBayxpRpuezk4qWrNeamc0P1AN7RyXfo9Wa9Gt7vs1bUQQeXp9MDwIVyS+JK4z8mz1mvcCCkKnruv1d0ljMD+w4CNAzcTVlguN+kXloU0/PmiEyXKbiBJgmUcgYMSjcN25gdmK5cyDMcjuy7GVcRpJVQdZhyuwKg4lm+D4GttpksiSPP0CLlWYG81ZbpHylgWhVOGJ9+u2gFqqajMziAWTfg/bQnHaatYZmDdy0cOkkSr9yow/Xxelfppdz5DRJ24VlJMBFcwo4BpGa/ViX2XG6iRYrcWpeKlUY88AUYVqf+E/uYXOmFWyWcAHWtd/trk0u6LIdpm6bxJbgT2MPWPbjDbDevSXR+xHJl9MbuOCb+9ar7p/JvwJvd83mhQG22bcMZKzFKmTTmEeiyck5/BOOgL2y6cfANi8XfH/4g49PIH5WlIpdtugRX8egXKX5gSXyzXehW81MXkVLzI7AWRcrkD3lVrkvf+bjLmnikTSmU0GoeUau35uJ0llJlnCRswEf9JA3J4dE7egkRI+WqUdzlwdnpbiodGFVdPSdkIIlPn0V6p/iDd2wtei2EPVMP/qoXy44udADIPJOqGAjLy0NTpy2++ECORnqX3D/5flrExYZjIMylEtZ4oqVxyzMdGwcCKeHJBffCCsA6Gb7y88erPySwAAAAAAAAAAAACaoAAAAAboUxkUhWbGbYoi/89XAmr9x8wBLAAABJoI/maSJ6aaw7g4EKzvjVCGSmXnW6Bs4wWgj3Cd1/mXGNiMOLiB5zBUwq+RUSiP5LPL6A0cYZGZYYYluufgwXDpTSdDFI2gjBTDYWbpmZaFnWIitihxTKdvWsRsg+uqZ0fp8/QwEu5bVe0M4bR26eB1a2GBS8OA9alUninLifIqpTz/w1Sj/C4aVguBogRQJ/P6N0t96g1Xyru63A5kRs59I5+ez0xTKw3g8KOmL6r1MdBZ8DCWbFEE2WtZFMeKu22lurMIJg9K1aS3KZj5Mvp3ZYA/fNklpfC79pnZHq+Eq6UnNvlacwyxjcwhRnQ81B78fH/kNT9BJfrRh1rq1XvSYGazEKeiWBFRdnyyz1yA6EawNF1mWL+NTTqYSsz1BSTQjPv9129fhs3JtoJOS/YSwyGcyUP7rZee/6tclpVKILbslc55MP3yiFEsySYNsa13npD0quRKKZYBwhq5PiZ2WqihoZzz+3KvTRYYRsHIaFecCXfjPOOrQPOq7p682htK5Kgw5OKb88Qh2CqrFci9h5q+ihn1YOAMbYAAAAAAAABK6LafOJeJYA5CnRp9x1uBuGEHhryLpdvqxdadDLGVItNhYthdBWkD/UWTHyftJuNYuf3AJCjz5UyDLDH1EK9nYtPnFWB2nXhn+Tov4vDREzfkrwSK2/3/OBW3f+/f//7dH//bM3//tq294Cf3SxXXvxSTeJpqzNgUi5fLXtIdn2BfbahDwJY6JmuxZRhHEEsfKklSv9uoL9yKJKPDUu5KDht7Pn1+8qGesnexbk220WLo4+2SF1n99M2bxQGmDx6zUN6uz66bw6jc2hkNsr1Vqwd7eqN2LmFkzoI+3b5mJ960btgGW82Hyn1hPgrJzjwWY7FPLGKaCfffExaf0XVV12TfqnZH02sErzmIdIAkDRD849F2DhEfvVMXEOEq7SXlxSdBZwuB3QpnlnW1E1XEaBVjHy9V+fUfp6whe2adthdEcgr8kU7OP/hhbgjZyjlLhNPx7/21yVWqzgDymURJgkvP67InT4Ra/0CwOEP/+qkj+eAAA==" alt="Aloha Doors" style="height: 30px; margin-bottom: 5px;">
    <div style="font-size: 9px; color: #666;">214 Main St. #119, El Segundo CA 90245 ‚Ä¢ (310) 414-0488 ‚Ä¢ alohadoors.com</div>
    <div style="margin-top: 3px; font-size: 8px;">Generated on ${new Date().toLocaleDateString()} at ${new Date().toLocaleTimeString()}</div>
</div>

</div>`;

    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // PAGE 2+: TECHNICAL SPECIFICATIONS WITH IMAGES - EACH CATEGORY ON OWN PAGE
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    
    if (allSpecs.length > 0) {
        allSpecs.forEach(specData => {
            
            // DOOR SPECIFICATIONS PAGE
            if (specData.specs.door.image || specData.specs.door.notes) {
                html += `
<div class="spec-page page-break">
    <div class="spec-page-header">
        <div>
            <div style="font-size: 20px; font-weight: 700; letter-spacing: 2px;">üö™ DOOR SPECIFICATIONS</div>
            <div style="opacity: 0.9; margin-top: 3px; font-size: 11px;">${specData.doorLabel} ‚Äî ${specData.doorType || 'Door'} ${specData.doorWidth && specData.doorHeight ? `‚Äî ${specData.doorWidth}" √ó ${specData.doorHeight}"` : ''}</div>
        </div>
        <div class="spec-page-info">
            <div class="spec-page-badge">QTY: ${specData.quantity}</div>
            <div>${job.estimateNumber || 'ESTIMATE'} ‚Ä¢ ${job.customerName || 'Customer'}</div>
        </div>
    </div>
    
    <div class="spec-content">
        <div class="spec-card">
            <div class="spec-grid">
                ${specData.specs.door.image ? `<div class="spec-image"><img src="${specData.specs.door.image}"></div>` : ''}
                ${specData.specs.door.notes ? `<div class="spec-details">${specData.specs.door.notes}</div>` : ''}
            </div>
        </div>
    </div>
    
    <div class="spec-footer">
        <strong>ALOHA DOORS</strong> ‚Ä¢ Door Specifications ‚Äî ${specData.doorLabel} ‚Ä¢ ${job.jobReference || job.estimateNumber || ''}
    </div>
</div>`;
            }
            
            // FRAME SPECIFICATIONS PAGE
            if (specData.specs.frame.image || specData.specs.frame.notes) {
                html += `
<div class="spec-page page-break">
    <div class="spec-page-header">
        <div>
            <div style="font-size: 20px; font-weight: 700; letter-spacing: 2px;">üî≤ FRAME SPECIFICATIONS</div>
            <div style="opacity: 0.9; margin-top: 3px; font-size: 11px;">${specData.doorLabel} ‚Äî ${specData.frameType || 'Frame'} ${specData.frameBrand ? `‚Äî ${specData.frameBrand}` : ''}</div>
        </div>
        <div class="spec-page-info">
            <div class="spec-page-badge">QTY: ${specData.quantity}</div>
            <div>${job.estimateNumber || 'ESTIMATE'} ‚Ä¢ ${job.customerName || 'Customer'}</div>
        </div>
    </div>
    
    <div class="spec-content">
        <div class="spec-card">
            <div class="spec-grid">
                ${specData.specs.frame.image ? `<div class="spec-image"><img src="${specData.specs.frame.image}"></div>` : ''}
                ${specData.specs.frame.notes ? `<div class="spec-details">${specData.specs.frame.notes}</div>` : ''}
            </div>
        </div>
    </div>
    
    <div class="spec-footer">
        <strong>ALOHA DOORS</strong> ‚Ä¢ Frame Specifications ‚Äî ${specData.doorLabel} ‚Ä¢ ${job.jobReference || job.estimateNumber || ''}
    </div>
</div>`;
            }
            
            // HARDWARE SPECIFICATIONS PAGES - Each hardware item on own page
            if (specData.specs.hardware && specData.specs.hardware.some(s => s.image || s.notes)) {
                specData.specs.hardware.forEach((hwSpec, hIdx) => {
                    if (hwSpec.image || hwSpec.notes) {
                        const hw = specData.hardware[hIdx];
                        const hwBrand = hw?.brand === 'Other' ? hw?.brandManual : hw?.brand;
                        const hwModel = hw?.model === 'Manual Entry' ? hw?.modelManual : hw?.model;
                        html += `
<div class="spec-page page-break">
    <div class="spec-page-header">
        <div>
            <div style="font-size: 20px; font-weight: 700; letter-spacing: 2px;">üîß HARDWARE SPECIFICATIONS</div>
            <div style="opacity: 0.9; margin-top: 3px; font-size: 11px;">${specData.doorLabel} ‚Äî ${hw?.label || 'Hardware'} ${hwBrand ? `‚Äî ${hwBrand}` : ''} ${hwModel ? `/ ${hwModel}` : ''}</div>
        </div>
        <div class="spec-page-info">
            <div class="spec-page-badge">QTY: ${specData.quantity}</div>
            <div>${job.estimateNumber || 'ESTIMATE'} ‚Ä¢ ${job.customerName || 'Customer'}</div>
        </div>
    </div>
    
    <div class="spec-content">
        <div class="spec-card">
            <div class="spec-grid">
                ${hwSpec.image ? `<div class="spec-image"><img src="${hwSpec.image}"></div>` : ''}
                ${hwSpec.notes ? `<div class="spec-details">${hwSpec.notes}</div>` : ''}
            </div>
        </div>
    </div>
    
    <div class="spec-footer">
        <strong>ALOHA DOORS</strong> ‚Ä¢ Hardware Specifications ‚Äî ${specData.doorLabel} ‚Ä¢ ${job.jobReference || job.estimateNumber || ''}
    </div>
</div>`;
                    }
                });
            }
        });
    }

    html += `</body></html>`;
    
    return html;
}

function printSpecSheet() {
    const html = generateCleanSpecSheetHTML();
    const win = window.open('', '_blank');
    if (!win) {
        alert('Please allow popups to print the spec sheet.');
        return;
    }
    win.document.write(html);
    win.document.close();
    win.onload = function() { win.print(); };
}

function saveSpecSheet() {
    const html = generateCleanSpecSheetHTML();
    const blob = new Blob([html], { type: 'text/html' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `Aloha-Doors-${AppState.job.estimateNumber || 'SpecSheet'}-${new Date().toISOString().slice(0,10)}.html`;
    a.click();
    URL.revokeObjectURL(url);
}

function copyOrderText() {
    let text = `ALOHA DOORS - SPEC SHEET\nEstimate #: ${AppState.job.estimateNumber || '‚Äî'}\nDate: ${AppState.job.estimateDate || new Date().toLocaleDateString()}\nCustomer: ${AppState.job.customerName || '‚Äî'}\n${AppState.job.jobAddress ? 'Address: ' + AppState.job.jobAddress + '\n' : ''}${AppState.job.deliveryAddress ? 'Deliver To: ' + AppState.job.deliveryAddress + '\n' : ''}${AppState.job.jobReference ? 'Reference: ' + AppState.job.jobReference + '\n' : ''}\n`;
    const customerName = AppState.job.customerName || '';
    AppState.doors.forEach((door, idx) => {
        const doorLabel = customerName ? `${customerName} - Door ${idx + 1}` : `Door #${idx + 1}`;
        text += `‚ïê‚ïê‚ïê ${doorLabel} ‚Äî QTY: ${door.quantity} ‚ïê‚ïê‚ïê\n`;
        text += `DOOR: ${getDoorTypeLabel(door.door.type) || '‚Äî'} | ${door.door.brand || '‚Äî'}\n  Size: ${door.door.width}"√ó${door.door.height}"√ó${door.door.thickness}" | Fire: ${door.door.fireRating}\n`;
        text += `FRAME: ${getFrameTypeLabel(door.frame.type) || '‚Äî'} | ${door.frame.brand || '‚Äî'}\n  Material: ${door.frame.material} | Anchors: ${door.frame.anchors}\n`;
        if (door.hardware.length > 0) { text += `HARDWARE:\n`; door.hardware.forEach(hw => { text += `  ‚Ä¢ ${hw.label} - ${hw.brand || '‚Äî'}${hw.qty > 1 ? ' √ó' + hw.qty : ''}\n`; }); }
        if (door.notes) text += `NOTES: ${door.notes}\n`; text += '\n';
    });
    navigator.clipboard.writeText(text).then(() => alert('‚úì Copied!'));
}

function importJSON(event) {
    const file = event.target.files[0]; if (!file) return;
    const reader = new FileReader();
    reader.onload = function(e) {
        try {
            const data = JSON.parse(e.target.result);
            if (data.job) AppState.job = data.job;
            if (data.doors?.length > 0) { AppState.doors = data.doors; AppState.activeIndex = 0; }
            if (data.savedConfigurations) Object.assign(SavedConfigurations, data.savedConfigurations);
            renderTabs(); loadDoorToForm(); alert('‚úì Loaded!');
        } catch (err) { alert('Error: ' + err.message); }
    };
    reader.readAsText(file); event.target.value = '';
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// CONFIGURATIONS - Now includes specs!
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function openConfigModal() { document.getElementById('configModal').classList.add('active'); renderSavedConfigs(); }
function closeConfigModal() { document.getElementById('configModal').classList.remove('active'); }

function saveCurrentConfig() { 
    const name = document.getElementById('configName').value.trim(); 
    if (!name) { alert('Enter a name.'); return; } 
    const door = AppState.doors[AppState.activeIndex]; 
    
    // Save everything EXCEPT quantity
    SavedConfigurations[name] = { 
        door: JSON.parse(JSON.stringify(door.door)), 
        frame: JSON.parse(JSON.stringify(door.frame)), 
        hardware: JSON.parse(JSON.stringify(door.hardware)),
        specs: JSON.parse(JSON.stringify(door.specs || { door: {}, frame: {}, hardware: [] })),
        notes: door.notes,
        savedAt: new Date().toISOString() 
    }; 
    document.getElementById('configName').value = ''; 
    renderSavedConfigs(); 
    alert(`‚úì "${name}" saved with spec sheets!`); 
}

function loadConfig(name) { 
    const config = SavedConfigurations[name]; 
    if (!config) return; 
    const door = AppState.doors[AppState.activeIndex]; 
    const currentQty = door.quantity; // Preserve quantity
    
    Object.assign(door.door, config.door); 
    Object.assign(door.frame, config.frame); 
    door.hardware = JSON.parse(JSON.stringify(config.hardware));
    door.specs = JSON.parse(JSON.stringify(config.specs || { door: {}, frame: {}, hardware: [] }));
    door.notes = config.notes || '';
    door.quantity = currentQty; // Keep original quantity
    
    loadDoorToForm(); 
    closeConfigModal(); 
    alert(`‚úì "${name}" loaded! Quantity unchanged.`); 
}

function deleteConfig(name) { if (confirm(`Delete "${name}"?`)) { delete SavedConfigurations[name]; renderSavedConfigs(); } }

function renderSavedConfigs() { 
    const container = document.getElementById('savedConfigsList'); 
    const configs = Object.keys(SavedConfigurations); 
    if (configs.length === 0) { container.innerHTML = '<p style="color:#9ca3af; text-align:center; padding:20px;">No saved configurations</p>'; return; } 
    container.innerHTML = configs.map(name => { 
        const c = SavedConfigurations[name]; 
        const hasSpecs = c.specs && ((c.specs.door?.image || c.specs.door?.notes) || (c.specs.frame?.image || c.specs.frame?.notes) || (c.specs.hardware?.some(s => s.image || s.notes)));
        return `<div style="border:1px solid #e5e7eb; border-radius:8px; padding:15px; margin-bottom:10px; display:flex; justify-content:space-between; align-items:center;">
            <div>
                <div style="font-weight:600;">${name} ${hasSpecs ? 'üìã' : ''}</div>
                <div style="font-size:12px; color:#6b7280;">${c.door?.type || '‚Äî'} | ${c.frame?.type || '‚Äî'} | ${c.hardware?.length || 0} hw</div>
            </div>
            <div style="display:flex; gap:8px;">
                <button class="btn btn-success btn-sm" onclick="loadConfig('${name}')">Load</button>
                <button class="btn btn-danger btn-sm" onclick="deleteConfig('${name}')">Delete</button>
            </div>
        </div>`; 
    }).join(''); 
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// EMAIL SYSTEM
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function openEmailModal() {
    const job = AppState.job;
    const door = AppState.doors[AppState.activeIndex];
    
    // Pre-fill subject
    const subject = `Aloha Doors Order - ${job.customerName || 'Customer'} - ${job.jobReference || job.estimateNumber}`;
    document.getElementById('emailSubject').value = subject;
    
    // Pre-fill body with order summary
    let body = `Hello,\n\nPlease find attached the door order specification sheet for:\n\n`;
    body += `Customer: ${job.customerName || '‚Äî'}\n`;
    body += `Estimate #: ${job.estimateNumber}\n`;
    body += `Job Reference: ${job.jobReference || '‚Äî'}\n`;
    body += `Date: ${job.estimateDate}\n\n`;
    
    // Add door summary
    body += `ORDER SUMMARY:\n`;
    body += `‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n`;
    
    AppState.doors.forEach((d, idx) => {
        const doorType = d.door.type ? getDoorTypeLabel(d.door.type) : 'Not specified';
        const size = (d.door.width && d.door.height) ? `${d.door.width}" √ó ${d.door.height}"` : 'Size TBD';
        body += `\nDoor #${idx + 1} (Qty: ${d.quantity})\n`;
        body += `  Type: ${doorType}\n`;
        body += `  Size: ${size}\n`;
        if (d.door.brand) body += `  Brand: ${d.door.brand}\n`;
        if (d.door.fireRating && d.door.fireRating !== 'None') body += `  Fire Rating: ${d.door.fireRating}\n`;
        if (d.hardware.length > 0) {
            body += `  Hardware: ${d.hardware.map(h => h.label).join(', ')}\n`;
        }
    });
    
    body += `\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n\n`;
    body += `Please see the attached specification sheet for complete details including technical specifications and images.\n\n`;
    body += `Thank you,\n`;
    body += `Aloha Doors\n`;
    
    document.getElementById('emailBody').value = body;
    document.getElementById('emailTo').value = '';
    document.getElementById('emailCc').value = '';
    
    document.getElementById('emailModal').classList.add('active');
}

function closeEmailModal() {
    document.getElementById('emailModal').classList.remove('active');
}

function sendEmail() {
    const to = document.getElementById('emailTo').value.trim();
    const cc = document.getElementById('emailCc').value.trim();
    const subject = document.getElementById('emailSubject').value.trim();
    const body = document.getElementById('emailBody').value;
    
    if (!to) {
        alert('Please enter a recipient email address.');
        return;
    }
    
    // First, download the spec sheet so user can attach it
    saveSpecSheet();
    
    // Build mailto URL
    let mailtoUrl = `mailto:${encodeURIComponent(to)}`;
    const params = [];
    
    if (cc) params.push(`cc=${encodeURIComponent(cc)}`);
    if (subject) params.push(`subject=${encodeURIComponent(subject)}`);
    if (body) params.push(`body=${encodeURIComponent(body)}`);
    
    if (params.length > 0) {
        mailtoUrl += '?' + params.join('&');
    }
    
    // Open email client
    window.location.href = mailtoUrl;
    
    // Close modal after short delay
    setTimeout(() => {
        closeEmailModal();
        alert('‚úì Email client opened!\n\nPlease attach the downloaded spec sheet file to your email.');
    }, 500);
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// PRESET SYSTEM
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function getPresets() {
    try {
        return JSON.parse(localStorage.getItem('alohaDoorsPresets') || '{}');
    } catch (e) {
        return {};
    }
}

function savePresetsToStorage(presets) {
    localStorage.setItem('alohaDoorsPresets', JSON.stringify(presets));
}

function populatePresetDropdown() {
    const select = document.getElementById('presetSelector');
    const presets = getPresets();
    const names = Object.keys(presets).sort();
    
    select.innerHTML = '<option value="">‚Äî Load Preset ‚Äî</option>';
    names.forEach(name => {
        const opt = document.createElement('option');
        opt.value = name;
        opt.textContent = name;
        select.appendChild(opt);
    });
}

function openSavePresetModal() {
    const door = AppState.doors[AppState.activeIndex];
    if (!door) return;
    
    // Generate preview
    const preview = document.getElementById('presetPreview');
    let previewHTML = '<strong>Door:</strong> ' + (door.door.type ? getDoorTypeLabel(door.door.type) : 'Not set');
    if (door.door.width && door.door.height) {
        previewHTML += ` (${door.door.width}" √ó ${door.door.height}")`;
    }
    if (door.door.brand) previewHTML += ' - ' + door.door.brand;
    
    previewHTML += '<br><strong>Frame:</strong> ' + (door.frame.type ? getFrameTypeLabel(door.frame.type) : 'Not set');
    if (door.frame.brand) previewHTML += ' - ' + door.frame.brand;
    
    previewHTML += '<br><strong>Hardware:</strong> ' + (door.hardware.length > 0 ? door.hardware.map(h => h.label).join(', ') : 'None');
    
    const hasImages = door.specs.door.image || door.specs.frame.image || (door.specs.hardware && door.specs.hardware.some(h => h.image));
    previewHTML += '<br><strong>Images:</strong> ' + (hasImages ? '‚úì Included' : 'None');
    
    preview.innerHTML = previewHTML;
    
    // Clear name field
    document.getElementById('presetName').value = '';
    
    // Show modal
    document.getElementById('savePresetModal').classList.add('active');
}

function closeSavePresetModal() {
    document.getElementById('savePresetModal').classList.remove('active');
}

function savePreset() {
    const name = document.getElementById('presetName').value.trim();
    if (!name) {
        alert('Please enter a preset name.');
        return;
    }
    
    const door = AppState.doors[AppState.activeIndex];
    if (!door) return;
    
    const presets = getPresets();
    
    // Check if name exists
    if (presets[name]) {
        if (!confirm(`Preset "${name}" already exists. Overwrite?`)) return;
    }
    
    // Save preset (excluding job info and quantity)
    presets[name] = {
        door: JSON.parse(JSON.stringify(door.door)),
        frame: JSON.parse(JSON.stringify(door.frame)),
        hardware: JSON.parse(JSON.stringify(door.hardware)),
        specs: JSON.parse(JSON.stringify(door.specs)),
        notes: door.notes,
        savedAt: new Date().toISOString()
    };
    
    savePresetsToStorage(presets);
    populatePresetDropdown();
    closeSavePresetModal();
    
    // Select the newly saved preset
    document.getElementById('presetSelector').value = name;
    
    alert(`‚úì Preset "${name}" saved!`);
}

function loadPreset(name) {
    if (!name) return;
    
    const presets = getPresets();
    const preset = presets[name];
    if (!preset) {
        alert('Preset not found.');
        return;
    }
    
    const door = AppState.doors[AppState.activeIndex];
    if (!door) return;
    
    // Keep current quantity
    const currentQty = door.quantity;
    
    // Load preset data
    door.door = JSON.parse(JSON.stringify(preset.door));
    door.frame = JSON.parse(JSON.stringify(preset.frame));
    door.hardware = JSON.parse(JSON.stringify(preset.hardware));
    door.specs = JSON.parse(JSON.stringify(preset.specs));
    door.notes = preset.notes || '';
    
    // Restore quantity
    door.quantity = currentQty;
    
    // Reload form
    loadDoorToForm();
    
    alert(`‚úì Preset "${name}" loaded! Quantity unchanged.`);
}

function deleteCurrentPreset() {
    const select = document.getElementById('presetSelector');
    const name = select.value;
    
    if (!name) {
        alert('Please select a preset to delete.');
        return;
    }
    
    if (!confirm(`Delete preset "${name}"?`)) return;
    
    const presets = getPresets();
    delete presets[name];
    savePresetsToStorage(presets);
    populatePresetDropdown();
    
    alert(`‚úì Preset "${name}" deleted.`);
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// INIT
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

document.addEventListener('DOMContentLoaded', function() {
    AppState.job.estimateDate = new Date().toISOString().slice(0, 10);
    AppState.job.estimateNumber = 'EST-' + Date.now().toString().slice(-6);
    AppState.doors.push(createNewDoor());
    populateBrandDropdown('doorBrand', 'doors');
    populateBrandDropdown('frameBrand', 'frames');
    populatePresetDropdown();
    renderTabs(); 
    loadDoorToForm();
});
</script>
</body>
</html>
